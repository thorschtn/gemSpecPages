<?xml version="1.0" encoding="UTF-8"?>
<requirements>
  <requirement id="A_20737" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-14" technicalID="ML-112000" revision="426785">
    <title><![CDATA[Ermöglichung einer organisatorischen Registrierung für Anwendungsfrontends und Fachdienste]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS eine organisatorische Registrierung von 
Anwendungsfrontends und Fachdiensten ermöglichen.]]></description>
    <description_html><![CDATA[Der Anbieter des IdP-Dienstes MUSS eine organisatorische Registrierung von Anwendungsfrontends und Fachdiensten ermöglichen.]]></description_html>
  </requirement>
  <requirement id="A_20687-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-117406" revision="426785">
    <title><![CDATA[Bereitstellung der öffentlichen Schlüsselteile]]></title>
    <description><![CDATA[Der Authorization Server MUSS zu allen verwendeten privaten Schlüsseln 
"PrK_IDP_SIG", "PrK_IDP_ENC" und "PrK_DISC_SIG" das öffentliche 
Pendant "PuK_IDP_SIG", "PuK_IDP_ENC" und "PuK_DISC_SIG" zum Download 
bereitstellen. Dies ermöglicht die Prüfung der von den einzelnen Schnittstellen 
vorgenommenen Signaturen ebenso wie die zielgerichtete Verschlüsselung des 
Payload für den bestimmten Empfänger.]]></description>
    <description_html><![CDATA[Der Authorization Server MUSS zu allen verwendeten privaten Schlüsseln &quot;PrK_IDP_SIG&quot;, &quot;PrK_IDP_ENC&quot; und &quot;PrK_DISC_SIG&quot; das öffentliche Pendant &quot;PuK_IDP_SIG&quot;, &quot;PuK_IDP_ENC&quot; und &quot;PuK_DISC_SIG&quot; zum Download bereitstellen. Dies ermöglicht die Prüfung der von den einzelnen Schnittstellen vorgenommenen Signaturen ebenso wie die zielgerichtete Verschlüsselung des Payload für den bestimmten Empfänger.]]></description_html>
  </requirement>
  <requirement id="A_20732" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-09" technicalID="ML-111991" revision="426785">
    <title><![CDATA[Aufnahme der öffentlichen Schlüssel in das Discovery Document]]></title>
    <description><![CDATA[Der Authorization Server MUSS zu jedem privaten Schlüssel dessen öffentlichen 
Teil mit einer eigenen absoluten URI in das Discovery Document aufnehmen.]]></description>
    <description_html><![CDATA[Der Authorization Server MUSS zu jedem privaten Schlüssel dessen öffentlichen Teil mit einer eigenen absoluten URI in das Discovery Document aufnehmen.]]></description_html>
  </requirement>
  <requirement id="A_20686" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-13" technicalID="ML-111894" revision="426785">
    <title><![CDATA[Erweiterte Nutzung von Schlüsseln]]></title>
    <description><![CDATA[Der Authorization Server MUSS die einzelnen Schnittstellen (AUTH, DISC, TOKEN) 
mit getrennten Interfaces bedienen.]]></description>
    <description_html><![CDATA[Der Authorization Server <span style="font-weight: normal;">MUSS d</span>ie einzelnen Schnittstellen (AUTH, DISC, TOKEN) mit getrennten Interfaces bedienen.]]></description_html>
  </requirement>
  <requirement id="A_20582-01" type="leafRequirement" severity="MUSS" lastUpdate="2020-11-12" technicalID="ML-112876" revision="426785">
    <title><![CDATA[IdP-Dienst - Berücksichtigung OWASP-Top-10-Risiken]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS Maßnahmen zum Schutz sowohl vor den zum Zulassungszeitpunkt 
aktuellen OWASP-Top-10-Risiken umsetzen, als auch nach den zum 
Zulassungszeitpunkt aktuellen OWASP-Top-10-Risiken.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS Maßnahmen zum Schutz sowohl vor den zum Zulassungszeitpunkt aktuellen OWASP-Top-10-Risiken umsetzen, als auch nach den zum Zulassungszeitpunkt aktuellen OWASP-Top-10-Risiken.]]></description_html>
  </requirement>
  <requirement id="A_21302" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-16" technicalID="ML-116307" revision="426785">
    <title><![CDATA[Interner Datenaustausch der Komponenten des IdP-Dienstes]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS für den internen Datenaustausch einen 
Mechanismus zur Sicherung der Datenintegrität, der Authentizität und zur 
Vertraulichkeit der Daten zur Verfügung stellen. ]]></description>
    <description_html><![CDATA[Der Anbieter des IdP-Dienstes MUSS für den internen Datenaustausch einen Mechanismus zur Sicherung der Datenintegrität, der Authentizität und zur Vertraulichkeit der Daten zur Verfügung stellen. ]]></description_html>
  </requirement>
  <requirement id="A_20583" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-111132" revision="426785">
    <title><![CDATA[IdP-Dienst – Sicherung zum Transportnetz Internet durch Paketfilter]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS dafür sorgen, dass das Transportnetz 
Internet durch einen Paketfilter (ACL) gesichert wird und ausschließlich die 
erforderlichen Protokolle weiterleitet. Der Anbieter des IdP-Dienstes MUSS 
dafür sorgen, dass  der Paketfilter des IdP-Dienstes frei konfigurierbar auf 
der Grundlage von Informationen aus OSI-Layer 3 und 4 ist, das heißt Quell- und 
Zieladresse, IP-Protokoll sowie Quell- und Zielport.]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des IdP-Dienstes MUSS dafür sorgen, dass das Transportnetz Internet durch einen Paketfilter (ACL) gesichert wird und ausschließlich die erforderlichen Protokolle weiterleitet. Der Anbieter des IdP-Dienstes MUSS dafür sorgen, dass  der Paketfilter des IdP-Dienstes frei konfigurierbar auf der Grundlage von Informationen aus OSI-Layer 3 und 4 ist, das heißt Quell- und Zieladresse, IP-Protokoll sowie Quell- und Zielport.</span>]]></description_html>
  </requirement>
  <requirement id="A_20584" type="leafRequirement" severity="DARF NICHT" lastUpdate="2021-12-15" technicalID="ML-111131" revision="426785">
    <title><![CDATA[IdP-Dienst – Platzierung des Paketfilters Internet]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes DARF den Paketfilter des IdP-Dienstes zum Schutz 
in Richtung Transportnetz Internet  NICHT physisch auf dem vorgeschalteten 
TLS-terminierenden Load Balancer implementieren.]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des IdP-Dienstes DARF den Paketfilter des IdP-Dienstes zum Schutz in Richtung Transportnetz Internet  NICHT physisch auf dem vorgeschalteten TLS-terminierenden Load Balancer implementieren.</span>]]></description_html>
  </requirement>
  <requirement id="A_20585-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117514" revision="426785">
    <title><![CDATA[IdP-Dienst-Anbieter – Richtlinien für den Paketfilter zum Internet]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS beim Paketfilter die Weiterleitung von 
IP-Paketen an der Schnittstelle zum Internet auf das HTTPS- Protokoll 
beschränken. ]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des IdP-Dienstes MUSS beim Paketfilter die Weiterleitung von IP-Paketen an der Schnittstelle zum Internet auf das HTTPS- Protokoll beschränken. </span>]]></description_html>
  </requirement>
  <requirement id="A_20586-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-112831" revision="426785">
    <title><![CDATA[IdP-Dienst – Verhalten bei Vollauslastung]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS den Paketfilter des IdP-Dienstes so 
konfigurieren, dass bei Vollauslastung der Systemressourcen im IdP-Dienst keine 
weiteren Verbindungen angenommen werden.]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des IdP-Dienstes MUSS den Paketfilter des IdP-Dienstes so konfigurieren, dass bei Vollauslastung der Systemressourcen im IdP-Dienst keine weiteren Verbindungen angenommen werden.</span>]]></description_html>
  </requirement>
  <requirement id="A_20587" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-111130" revision="426785">
    <title><![CDATA[IdP-Dienst – Richtlinien zum TLS-Verbindungsaufbau]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS dafür sorgen, dass der Eingangspunkt des 
IdP-Dienstes sich beim TLS-Verbindungsaufbau über das Transportnetz gegenüber 
dem Client mit einem Extended Validation TLS-Zertifikat eines Herausgebers 
gemäß [CAB-Forum] authentisiert. Der Anbieter MUSS dafür sorgen, dass das 
Zertifikat sich an die jeweilige Schnittstelle des Eingangspunkts für 
Primärsysteme, Authenticator-Module und Frontends der Versicherten des 
IdP-Dienstes bindet, damit Clientsysteme beim TLS-Verbindungsaufbau eine 
vereinfachte Zertifikatsprüfung mit TLS-Standardbibliotheken durchführen können.]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des IdP-Dienstes MUSS dafür sorgen, dass der Eingangspunkt des IdP-Dienstes sich beim TLS-Verbindungsaufbau über das Transportnetz gegenüber dem Client mit einem Extended Validation TLS-Zertifikat eines Herausgebers gemäß [CAB-Forum] authentisiert. Der Anbieter MUSS dafür sorgen, dass das Zertifikat sich an die jeweilige Schnittstelle des Eingangspunkts für Primärsysteme, Authenticator-Module und Frontends der Versicherten des IdP-Dienstes bindet, damit Clientsysteme beim TLS-Verbindungsaufbau eine vereinfachte Zertifikatsprüfung mit TLS-Standardbibliotheken durchführen können.</span>]]></description_html>
  </requirement>
  <requirement id="A_20680" type="leafRequirement" severity="MUSS" lastUpdate="2020-11-12" technicalID="ML-111889" revision="426785">
    <title><![CDATA[Format der Fehlermeldungen]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS für die verschiedenen Teilfunktionen geeignete 
Fehlermeldungen erzeugen und diese an den jeweiligen Aufrufer übergeben.]]></description>
    <description_html><![CDATA[Der IdP-Dienst <span style="font-weight: normal;">MUSS</span><span style="font-weight: bold;"> </span>für die verschiedenen Teilfunktionen geeignete Fehlermeldungen erzeugen und diese an den jeweiligen Aufrufer übergeben.]]></description_html>
  </requirement>
  <requirement id="A_20681" type="leafRequirement" severity="MUSS" lastUpdate="2020-10-08" technicalID="ML-111888" revision="426785">
    <title><![CDATA[Nutzung von eindeutigen Error-Codes bei der Erstellung von Fehlermeldungen]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS Fehler durch eine eindeutige Nummer erkennbar machen und 
der gematik eine Liste der Error-Codes zur Verfügung stellen, damit die 
Ursachenklärung vereinfacht möglich wird.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS Fehler durch eine eindeutige Nummer erkennbar machen und der gematik eine Liste der Error-Codes zur Verfügung stellen, damit die Ursachenklärung vereinfacht möglich wird.]]></description_html>
  </requirement>
  <requirement id="A_20682-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117515" revision="426785">
    <title><![CDATA[Verwendung eines einheitlichen Schemas für die Aufbereitung von Fehlermeldungen]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS alle ausgeworfenen Fehlermeldungen zur Weiterverarbeitung 
in einem einheitlichen Schema aufbereiten und bereitstellen. Zeitstempel MÜSSEN 
auf der UTC basieren. ]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der IdP-Dienst MUSS alle ausgeworfenen Fehlermeldungen zur Weiterverarbeitung in einem einheitlichen Schema aufbereiten und bereitstellen. Zeitstempel MÜSSEN auf der UTC basieren. </span><p data-keep-next="true" class="polarion-rte-caption-paragraph"></p>]]></description_html>
  </requirement>
  <requirement id="A_20683" type="leafRequirement" severity="MUSS" lastUpdate="2020-10-08" technicalID="ML-111893" revision="426785">
    <title><![CDATA[Formulierung der Fehlermeldungen]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS Fehlermeldungen, welche dem Nutzer angezeigt werden, in der 
Art ausformulieren, dass es dem Nutzer möglich ist, eigenes Fehlverhalten 
anhand der Fehlermeldung abzustellen.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS Fehlermeldungen, welche dem Nutzer angezeigt werden, in der Art ausformulieren, dass es dem Nutzer möglich ist, eigenes Fehlverhalten anhand der Fehlermeldung abzustellen.]]></description_html>
  </requirement>
  <requirement id="A_20684" type="leafRequirement" severity="MUSS" lastUpdate="2020-10-08" technicalID="ML-111891" revision="426785">
    <title><![CDATA[Nutzung einer eindeutigen Beschreibung beim Aufbau von Fehlermeldungen]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS jedem Fehler eine eindeutige eigene Beschreibung zukommen 
lassen, sodass eine Fehlermeldung nicht für unterschiedliche Fehlerursachen zur 
Anwendung kommt.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS jedem Fehler eine eindeutige eigene Beschreibung zukommen lassen, sodass eine Fehlermeldung nicht für unterschiedliche Fehlerursachen zur Anwendung kommt.]]></description_html>
  </requirement>
  <requirement id="A_20685" type="leafRequirement" severity="MUSS" lastUpdate="2020-10-08" technicalID="ML-111892" revision="426785">
    <title><![CDATA[Ausgabe der Fehlermeldungen in umgekehrter Reihenfolge des Auftretens]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS aufeinander aufbauende Fehlermeldungen in der umgekehrten 
Reihenfolge ihres Auftretens "Traceback (most recent call last)" ausgeben.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS aufeinander aufbauende Fehlermeldungen in der umgekehrten Reihenfolge ihres Auftretens &quot;Traceback (most recent call last)&quot; ausgeben.]]></description_html>
  </requirement>
  <requirement id="A_20588-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116773" revision="426785">
    <title><![CDATA[IdP-Dienst - Erkennung Clientsystem User-Agent]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS das vom aufrufenden Nutzer verwendete Clientsystem 
(Authenticator-Modul, E-Rezept-FdV oder Primärsystem) anhand des im 
HTTP-Request enthaltenen Header-Feld "User-Agent" gemäß [RFC7231] erkennen und 
in den Einträgen zur Performance-Rohdatenerfassung gemäß [gemSpec_Perf] 
protokollieren. Der IdP-Dienst MUSS bei fehlendem User-Agent-Header den Request 
mit dem HTTP-Status-Code 403 beantworten, damit in der Betriebsüberwachung des 
IdP-Dienstes die Nutzung unzulässiger Clientsysteme erkannt werden kann.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS das vom aufrufenden Nutzer verwendete Clientsystem (Authenticator-Modul, E-Rezept-FdV oder Primärsystem) anhand des im HTTP-Request enthaltenen Header-Feld &quot;User-Agent&quot; gemäß [RFC7231] erkennen und in den Einträgen zur Performance-Rohdatenerfassung gemäß [gemSpec_Perf] protokollieren. Der IdP-Dienst MUSS bei fehlendem User-Agent-Header den Request mit dem HTTP-Status-Code 403 beantworten, damit in der Betriebsüberwachung des IdP-Dienstes die Nutzung unzulässiger Clientsysteme erkannt werden kann.]]></description_html>
  </requirement>
  <requirement id="A_20589" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-09" technicalID="ML-111136" revision="426785">
    <title><![CDATA[IdP-Dienst – Ausschluss bestimmter Clientsystem-Versionsnummern von der Kommunikation]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS die aus dem Internet vom Clientsystem mitgeteilte 
Versionsnummer aus dem HTTP-Header User-Agent, erkennen und festgelegte 
Versionsnummern über ein Blacklisting von einer Kommunikation mit dem 
IdP-Dienst ausschließen können. Der IdP-Dienst MUSS in diesen Fällen eine 
entsprechende Fehlermeldung an das Clientsystem geben.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS die aus dem Internet vom Clientsystem mitgeteilte Versionsnummer aus dem HTTP-Header User-Agent, erkennen und festgelegte Versionsnummern über ein Blacklisting von einer Kommunikation mit dem IdP-Dienst ausschließen können. Der IdP-Dienst MUSS in diesen Fällen eine entsprechende Fehlermeldung an das Clientsystem geben.]]></description_html>
  </requirement>
  <requirement id="A_20590" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-09" technicalID="ML-111135" revision="426785">
    <title><![CDATA[IdP-Dienst – Ausschluss von Clientsystem-Versionen]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS ausschließlich auf Anweisung der gematik 
Clientsysteme mit bestimmten Versionsnummern von einer Kommunikation mit dem 
IdP-Dienst ausschließen.]]></description>
    <description_html><![CDATA[Der Anbieter des IdP-Dienstes MUSS ausschließlich auf Anweisung der gematik Clientsysteme mit bestimmten Versionsnummern von einer Kommunikation mit dem IdP-Dienst ausschließen.]]></description_html>
  </requirement>
  <requirement id="A_20742-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117592" revision="426785">
    <title><![CDATA[Vergabe der "client_id" durch den Anbieter des IdP-Dienstes]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS bei der organisatorischen Registrierung des 
Anwendungsfrontends diesem eine eindeutige "client_id" zur Nutzung des 
IdP-Dienstes zuweisen.]]></description>
    <description_html><![CDATA[Der Anbieter des IdP-Dienstes MUSS bei der organisatorischen Registrierung des Anwendungsfrontends diesem eine eindeutige &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span>&quot; zur Nutzung des IdP-Dienstes zuweisen.]]></description_html>
  </requirement>
  <requirement id="A_21472" type="leafRequirement" severity="MUSS" lastUpdate="2021-09-30" technicalID="ML-117360" revision="426785">
    <title><![CDATA[SSO_TOKEN nur für Mobile Endgeräte und nicht für Primärsysteme]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS bei der organisatorischen Registrierung eines Clients 
anhand seiner "client_id" - beispielsweise des Anwendungsfrontends oder eines 
Primärsystems - festlegen, ob im Authorization Code Flow bei der Ausgabe eines 
"AUTHORIZATION_CODE" auch ein "SSO_TOKEN" vom IDP-Dienst ausgegeben werden muss.]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der IdP-Dienst MUSS bei der organisatorischen Registrierung eines Clients anhand seiner &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span>&quot; - beispielsweise des Anwendungsfrontends oder eines Primärsystems - festlegen, ob im Authorization Code Flow bei der Ausgabe eines &quot;AUTHORIZATION_CODE&quot; auch ein &quot;SSO_TOKEN&quot; vom IDP-Dienst ausgegeben werden muss.</span>]]></description_html>
  </requirement>
  <requirement id="A_22280" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124989" revision="426785">
    <title><![CDATA[Registrierung des IDP-Dienstes als Client bei sektoralen Identity Providern]]></title>
    <description><![CDATA[Der Anbieter des IDP-Dienstes MUSS diesen bei allen sektoralen Identity 
Providern als Confidential Client (gemäß [RFC6749#section-2.1]) registrieren. 
Hierbei müssen die folgenden Metadaten verwendet werden: 
Datenobjekt Wert Anmerkungen 
client_id "zentraler-idp-dienst" 

redirect_uri URIs, von denen der sektorale Idenitity Provider Authorization 
Requests entgegennimmt Der sektorale Identity Provider muss hier den IDP-Dienst 
mit all jenen "kk_app_redirect_uri"-Adressen registrieren, die er unterstützt. 
PuK_IDP_SIG_Sek öffentlicher Authentifizierungsschlüssel des zentralen 
IDP-Dienstes gegenüber den sektoralen Identity Providern Mindestens ein 
Schlüssel ist zu übergeben.]]></description>
    <description_html><![CDATA[Der Anbieter des IDP-Dienstes MUSS diesen bei allen sektoralen Identity Providern als C<span style="font-style: normal;">onfidential</span> Client (gemäß [RFC6749#section-2.1]) registrieren. Hierbei müssen die folgenden Metadaten verwendet werden: 
<table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
  <tbody>
    <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 97.675px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datenobjekt</th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 235.887px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wert</th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 235.637px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anmerkungen</th>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 97.675px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">client_id</td>
      <td style="text-align: left;vertical-align: top;width: 235.887px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&quot;zentraler-idp-dienst&quot;</td>
      <td style="text-align: left;vertical-align: top;width: 235.637px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><br/>
      </td>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 97.675px;height: 76.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">redirect_uri</td>
      <td style="text-align: left;vertical-align: top;width: 235.887px;height: 76.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">URIs, von denen der sektorale Idenitity Provider Authorization Requests entgegennimmt</td>
      <td style="text-align: left;vertical-align: top;width: 235.637px;height: 76.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der sektorale Identity Provider muss hier den IDP-Dienst mit all jenen &quot;kk_app_redirect_uri&quot;-Adressen registrieren, die er unterstützt.</td>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 97.675px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PuK_IDP_SIG_Sek</td>
      <td style="text-align: left;vertical-align: top;width: 235.887px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">öffentlicher Authentifizierungsschlüssel des zentralen IDP-Dienstes gegenüber den sektoralen Identity Providern</td>
      <td style="text-align: left;vertical-align: top;width: 235.637px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Mindestens ein Schlüssel ist zu übergeben.</td>
    </tr>
  </tbody>
</table>
<span id="polarion-comment:1631"></span>]]></description_html>
  </requirement>
  <requirement id="A_22282" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124988" revision="426785">
    <title><![CDATA[Periodisches Einlesen der Discovery Documents und Schlüssel der sektoralen Identity Provider]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS die Discovery Documents und JWKS-Schlüsselsätze der 
sektoralen Identity Provider, bei denen er registriert ist, mindestens einmal 
stündlich aktualisieren.

 Erfolgreich eingelesene Discovery Documents und Schlüssel dürfen im Fall 
einer Nicht-Erreichbarkeit des Downloadpunktes für maximal 24 Stunden verwendet 
werden.]]></description>
    <description_html><![CDATA[Der IDP-Dienst MUSS die Discovery Documents und JWKS-Schlüsselsätze der sektoralen Identity Provider, bei denen er registriert ist, mindestens einmal stündlich aktualisieren.<br/>
<br/>
Erfolgreich eingelesene Discovery Documents und Schlüssel dürfen im Fall einer Nicht-Erreichbarkeit des Downloadpunktes für<span id="polarion-comment:1630"></span> maximal 24 Stunden verwendet werden.]]></description_html>
  </requirement>
  <requirement id="A_20457" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-13" technicalID="ML-110662" revision="426785">
    <title><![CDATA[Verwendung eindeutiger URI]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS alle verwendeten Adressen in Form von URL gemäß [RFC1738 
<https://tools.ietf.org/html/rfc1738> ] angeben und in einem Discovery Document 
gemäß [RFC8414 # section-2 <https://tools.ietf.org/html/rfc8414#section-2>] 
innerhalb der TI und im Internet veröffentlichen.]]></description>
    <description_html><![CDATA[Der IdP-Dienst <span style="font-weight: normal;">MUSS </span>alle verwendeten Adressen in Form von URL gemäß [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc1738">RFC1738</a> ] angeben und in einem Discovery Document gemäß [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc8414#section-2">RFC8414 # section-2</a>] innerhalb der TI und im Internet veröffentlichen.]]></description_html>
  </requirement>
  <requirement id="A_20688" type="leafRequirement" severity="MUSS" lastUpdate="2020-11-12" technicalID="ML-111896" revision="426785">
    <title><![CDATA[Discovery Document interne und externe Adressierung]]></title>
    <description><![CDATA[Der Discovery-Endpunkt MUSS die Discovery Documents für interne und externe 
Adressierung sowohl innerhalb der TI als auch im Internet veröffentlichen.]]></description>
    <description_html><![CDATA[Der Discovery-Endpunkt MUSS <span style="font-size: 10pt;line-height: 1.5;">die Discovery Documents für interne und externe Adressierung</span> sowohl innerhalb der TI als auch im Internet veröffentlichen.]]></description_html>
  </requirement>
  <requirement id="A_20689-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117511" revision="426785">
    <title><![CDATA[Internes Discovery Document - Prüfung der angebotenen URL]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS alle von ihm im internen Discovery Document angebotenen URL 
ständig auf bloße Erreichbarkeit prüfen.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS alle von ihm im internen Discovery Document angebotenen URL ständig auf bloße Erreichbarkeit prüfen.]]></description_html>
  </requirement>
  <requirement id="A_20690-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117512" revision="426785">
    <title><![CDATA[Externes Discovery Document - Prüfung der angebotenen URL]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS alle von ihm im externen Discovery Document angebotenen URL 
ständig auf bloße Erreichbarkeit prüfen.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS alle von ihm im externen Discovery Document angebotenen URL ständig auf bloße Erreichbarkeit prüfen.]]></description_html>
  </requirement>
  <requirement id="A_20439" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-09" technicalID="ML-110634" revision="426785">
    <title><![CDATA[Das Discovery Document enthält statische Adressen]]></title>
    <description><![CDATA[Der Discovery-Endpunkt MUSS sowohl im internen, als auch im externen Discovery 
Document die Akteure mit  ihrer URI veröffentlichen.]]></description>
    <description_html><![CDATA[Der Discovery-Endpunkt MUSS sowohl im internen, als auch im externen Discovery Document die Akteure mit  ihrer URI veröffentlichen. <br/>]]></description_html>
  </requirement>
  <requirement id="A_20458-02" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-116962" revision="426785">
    <title><![CDATA[Inhalte des Discovery Document]]></title>
    <description><![CDATA[Der Discovery-Endpunkt MUSS sowohl im internen, als auch im externen Discovery 
Document gemäß [RFC8414 # section-2 
<https://tools.ietf.org/html/rfc8414#section-2>] mindestens die folgenden 
Attribute als URI angeben:

 * "issuer" (hier ist der IdP-Dienst erreichbar) 

 * "jwks_uri" (für den Abruf von „PUK_IDP_ENC“ sowie des öffentlichen 
Schlüssels und des Zertifikats von „PUK_IDP_SIG“ entsprechend 
TAB_IDP_DIENST_0003   [RFC7517] – identifiziert anhand der „kid“-Parameter 
(puk_idp_enc / puk_idp_sig)

 * "uri_disc" (URI, unter welcher das Discovery Document bereitgestellt wird)

 * "authorization_endpoint" (URI des Dienstes und des öffentlichen 
Verschlüsselungsschlüssels des Authorization-Endpunktes gemäß [RFC6749])

 * "sso_endpoint“ (URI des Authorization-Endpunktes für Requests mit SSO-Token)
 * "auth_pair_endpoint“ (URI des Authorization-Endpunktes für Requests mit 
Pairing-Daten)
 * "token_endpoint" (URI des Token-Endpunktes gemäß [RFC6749 ])

 * "uri_puk_idp_enc“ und „uri_puk_idp_sig“ (URI der JWK Objekte für die zwei 
Schlüssel und des Zertifikates).]]></description>
    <description_html><![CDATA[Der Discovery-Endpunkt MUSS sowohl im internen, als auch im externen Discovery Document gemäß [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc8414#section-2">RFC8414 # section-2</a>] mindestens die folgenden Attribute als URI angeben:<br/> <ul><li>&quot;issuer&quot; (hier ist der IdP-Dienst erreichbar) <br/></li><li>&quot;jwks_uri&quot; (für den Abruf von „PUK_IDP_ENC“ sowie des öffentlichen Schlüssels und des Zertifikats von „PUK_IDP_SIG“ entsprechend TAB_IDP_DIENST_0003   [RFC7517] – identifiziert anhand der „kid“-Parameter (puk_idp_enc / puk_idp_sig)<br/></li><li>&quot;uri_disc&quot; (URI, unter welcher das Discovery Document bereitgestellt wird)<br/></li><li>&quot;authorization_endpoint&quot; (URI des Dienstes und des öffentlichen Verschlüsselungsschlüssels des Authorization-Endpunktes gemäß [RFC6749])<br/></li><li>&quot;sso_endpoint“ (URI des Authorization-Endpunktes für Requests mit SSO-Token)</li><li>&quot;auth_pair_endpoint“ (URI des Authorization-Endpunktes für Requests mit Pairing-Daten)</li><li>&quot;token_endpoint&quot; (URI des Token-Endpunktes gemäß [RFC6749 ])<br/></li><li>&quot;uri_puk_idp_enc“ und „uri_puk_idp_sig“ (URI der JWK Objekte für die zwei Schlüssel und des Zertifikates).</li></ul>]]></description_html>
  </requirement>
  <requirement id="A_22286" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124991" revision="426785">
    <title><![CDATA[Erweiterung des Discovery Document des IDP-Dienstes]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS im Discovery Document unter dem Schlüssel "kk_app_list_uri" 
die URL der Liste der registrierten Authenticator-Module der sektoralen 
Identity Provider publizieren.]]></description>
    <description_html><![CDATA[Der IDP-Dienst MUSS im Discovery Document unter dem Schlüssel &quot;kk_app_list_uri&quot; die URL der Liste der registrierten Authenticator-Module der sektoralen Identity Provider publizieren.]]></description_html>
  </requirement>
  <requirement id="A_22287" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124994" revision="426785">
    <title><![CDATA[Veröffentlichung des Third-Party Authorization Endpoint]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS die URL des angebotenen Third-Party Authorization Endpoint 
im Discovery Document unter dem Schlüssel "third_party_authorization_endpoint" 
publizieren.]]></description>
    <description_html><![CDATA[<span style="font-weight: normal;">Der IDP-Dienst MUSS die URL des angebotenen Third-Party Authorization Endpoint im Discovery Document unter dem Schlüssel &quot;third_party_authorization_endpoint&quot; publizieren.</span> <br/>]]></description_html>
  </requirement>
  <requirement id="A_20691-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-117477" revision="426785">
    <title><![CDATA[Das Discovery Document ist maximal 24 Stunden alt]]></title>
    <description><![CDATA[Der Discovery-Endpunkt MUSS das Discovery Document regelmäßig alle 24 Stunden 
oder nach durchgeführten Änderungen umgehend neu erstellen, mit dem
"PrK_DISC_SIG" signieren und am mit der gematik vereinbarten Downloadpunkt 
"URI_DISC" bereitstellen.]]></description>
    <description_html><![CDATA[Der Discovery-Endpunkt MUSS das Discovery Document regelmäßig alle 24 Stunden oder nach durchgeführten Änderungen umgehend neu erstellen, mit dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;PrK_DISC_SIG&quot; </span>signieren und am mit der gematik vereinbarten Downloadpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;URI_DISC&quot; </span>bereitstellen.]]></description_html>
  </requirement>
  <requirement id="A_19874-05" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117509" revision="426785">
    <title><![CDATA[Bereitstellung des internen Discovery Documents innerhalb der TI]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS das interne Discovery Document mit einem Zertifikat des 
Typs FD.SIG und der technischen Rolle „oid_idpd“ gemäß [gemSpec_OID # Abschnitt 
3.5.4] signiert, an einem spezifischen Downloadpunkt TLS-gesichert innerhalb 
der TI bereitstellen.
 Die URL des Downloadpunktes lautet: "
https://idp.zentral.idp.splitdns.ti-dienste.de/.wellknown/openid-configuration
". ]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der IdP-Dienst MUSS das interne Discovery Document mit einem Zertifikat des Typs FD.SIG und der technischen Rolle „oid_idpd“ gemäß [<span style="font-size: 11pt;color: #172B4D;line-height: 1.5;">gemSpec_OID # Abschnitt 3.5.4</span>] signiert, an einem spezifischen Downloadpunkt TLS-gesichert innerhalb der TI bereitstellen.<br/>
  Die URL des Downloadpunktes lautet: &quot;<span style="font-weight: bold;">https://idp.zentral.idp.splitdns.ti-dienste.de/.wellknown/openid-configuration</span>&quot;. </span>]]></description_html>
  </requirement>
  <requirement id="A_19877-04" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-125073" revision="426785">
    <title><![CDATA[Bereitstellung des externen Discovery Documents im Internet]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS das externe Discovery Document mit einem Zertifikat des 
Typs FD.SIG und der technischen Rolle „oid_idpd“ gemäß [gemSpec_OID # Abschnitt 
3.5.4] signiert und TLS-gesichert im Internet zum Download bereitstellen.
 Die URL des Downloadpunktes lautet: "
https://idp.app.ti-dienste.de/.well-known/openid-configuration 
<https://idp.app.ti-dienste.de/.well-known/openid-configuration>" ]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der IdP-Dienst MUSS das externe Discovery Document mit einem Zertifikat des Typs FD.SIG und der technischen Rolle „oid_idpd“ gemäß [<span style="font-size: 11pt;color: #172B4D;line-height: 1.5;">gemSpec_OID # Abschnitt 3.5.4</span>] signiert und TLS-gesichert im Internet zum Download bereitstellen.<br/> Die URL des Downloadpunktes lautet: &quot;<span style="font-weight: bold;"><a class="descriptionLink" target="_top" href="https://idp.app.ti-dienste.de/.well-known/openid-configuration">https://idp.app.ti-dienste.de/.well-known/openid-configuration</a></span>&quot; <span id="polarion-comment:1609"></span></span><br/>]]></description_html>
  </requirement>
  <requirement id="A_20591-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116333" revision="426785">
    <title><![CDATA[Festlegungen zur Signatur der Discovery Documents]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS die Signatur der Discovery Documents dabei durch die 
Verwendung einer JSON Web Signature (JWS) [RFC7515 # section-3 - Compact 
Serialization] und des Schüssels PrK_DISC_SIG gewährleisten. Als Algorithmus 
ist dementsprechend "BP256R1" zu wählen.
Der IdP-Dienst MUSS bei der Signaturerstellung das Signaturzertifikat des 
PUK_DISC_SIG im x5c Claim einbetten.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS die Signatur der Discovery Documents dabei durch die Verwendung einer JSON Web Signature (JWS) [RFC7515 # section-3 - Compact Serialization] und des Schüssels PrK_DISC_SIG gewährleisten. Als Algorithmus ist dementsprechend &quot;BP256R1&quot; zu wählen.<br/>Der IdP-Dienst MUSS bei der Signaturerstellung das Signaturzertifikat des PUK_DISC_SIG im x5c Claim einbetten.]]></description_html>
  </requirement>
  <requirement id="A_22283" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124993" revision="426785">
    <title><![CDATA[Bereitstellung einer Liste der registrierten Authenticator-Module von sektoralen Identity Providern]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS unter einer dedizierten URL eine Liste der registrierten 
Authenticator-Module von sektoralen Identity Providern bereitstellen, die eine 
Vielzahl von Einträgen des folgenden Typs enthält:

Datum Erläuterung Anmerkung 
kk_app_name Ein für den Benutzer der Anwendungsfrontends interpretierbarer 
Name der Anwendung. Maximal 128 Zeichen. Wird durch sektoralen Identity 
Provider festgelegt.

kk_app_id  ID des Authenticator-Moduls des sektoralen IDP, welcher die 
Authentisierung für Versicherte dieser Krankenkasse durchführt. Maximal 32 
VSCHAR (analog client_id nach [RFC6749]). Wird durch IDP-Dienst festgelegt.]]></description>
    <description_html><![CDATA[<span style="font-weight: normal;">Der IDP-Dienst MUSS unter einer dedizierten URL eine Liste der registrierten Authenticator-Module von sektoralen Identity Providern bereitstellen, die eine Vielzahl von Einträgen des folgenden Typs enthält:<br/>
</span> 
<table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
  <tbody>
    <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 113.037px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datum</th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 318.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Erläuterung</th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 138.062px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anmerkung</th>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 113.037px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">kk_app_name</td>
      <td style="text-align: left;vertical-align: top;width: 318.1px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ein für den Benutzer der Anwendungsfrontends interpretierbarer Name der Anwendung. Maximal 128 Zeichen.</td>
      <td style="text-align: left;vertical-align: top;width: 138.062px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wird durch sektoralen Identity Provider festgelegt.<br/>
      </td>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 113.037px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">kk_app_id </td>
      <td style="text-align: left;vertical-align: top;width: 318.1px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ID des Authenticator-Moduls des sektoralen IDP, welcher die Authentisierung für Versicherte dieser Krankenkasse durchführt. Maximal 32 VSCHAR (analog client_id nach [RFC6749]).</td>
      <td style="text-align: left;vertical-align: top;width: 138.062px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wird durch IDP-Dienst festgelegt.</td>
    </tr>
  </tbody>
</table>]]></description_html>
  </requirement>
  <requirement id="A_22288" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124995" revision="426785">
    <title><![CDATA[Weitere Informationen zu registrierten sektoralen Authenticator-Modulen]]></title>
    <description><![CDATA[Neben den gemäß [A_22283] bereitgestellten Informationen MUSS der IDP-Dienst 
für jedes registrierte Authenticator-Modul eines sektoralen Identity Provider 
die folgenden Werte erfassen:

Datum Erläuterung Anmerkung 
kk_app_uri  Aufzurufende URI für die Authentisierung. Hiermit ist die 
entsprechende App auf dem Gerät registriert (URL).  Wird durch sektoralen 
Identity Provider festgelegt.

idp_iss  iss-Wert des sektoralen Identity Provider (URL). Wird durch 
sektoralen Identity Provider festgelegt.]]></description>
    <description_html><![CDATA[<span style="font-weight: normal;">Neben den gemäß [A_22283] bereitgestellten Informationen MUSS der IDP-Dienst für jedes registrierte Authenticator-Modul eines sektoralen Identity Provider die folgenden Werte erfassen:<br/>
</span> 
<table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
  <tbody>
    <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 113.037px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datum</th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 318.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Erläuterung</th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 138.062px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anmerkung</th>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 113.037px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">kk_app_uri </td>
      <td style="text-align: left;vertical-align: top;width: 318.1px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Aufzurufende URI für die Authentisierung. Hiermit ist die entsprechende App auf dem Gerät registriert (URL). </td>
      <td style="text-align: left;vertical-align: top;width: 138.062px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wird durch sektoralen Identity Provider festgelegt.<br/>
      </td>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 113.037px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">idp_iss </td>
      <td style="text-align: left;vertical-align: top;width: 318.1px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">iss-Wert des sektoralen Identity Provider (URL).</td>
      <td style="text-align: left;vertical-align: top;width: 138.062px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wird durch sektoralen Identity Provider festgelegt.</td>
    </tr>
  </tbody>
</table>]]></description_html>
  </requirement>
  <requirement id="A_22284" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124990" revision="426785">
    <title><![CDATA[Festlegungen zur Signatur der Liste der registrierten Authenticator-Module von sektoralen Identity Providern]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS die Signatur der Liste der registrierten 
Authenticator-Module von sektoralen Identity Providern durch die Verwendung 
einer JSON Web Signature (JWS) [RFC7515 # section-3 - Compact Serialization] 
und des Schüssels "PrK_DISC_SIG" gewährleisten. Als Algorithmus ist 
dementsprechend "BP256R1" zu wählen. Der IDP-Dienst MUSS bei der 
Signaturerstellung das Signaturzertifikat des "PUK_DISC_SIG" im x5c-Claim 
einbetten.]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der IDP-Dienst MUSS die Signatur der Liste der registrierten Authenticator-Module von sektoralen Identity Providern durch die Verwendung einer JSON Web Signature (JWS) [RFC7515 # section-3 - Compact Serialization] und des Schüssels &quot;PrK_DISC_SIG&quot; gewährleisten. Als Algorithmus ist dementsprechend &quot;BP256R1&quot; zu wählen. Der IDP-Dienst MUSS bei der Signaturerstellung das Signaturzertifikat des &quot;PUK_DISC_SIG&quot; im x5c-Claim einbetten.</span>]]></description_html>
  </requirement>
  <requirement id="A_22285" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124992" revision="426785">
    <title><![CDATA[Vergabe einer eindeutigen ID je Authenticator-Modul der sektoralen Identity Provider]]></title>
    <description><![CDATA[Der Anbieter des IDP-Dienstes MUSS für alle registrierten Authenticator-Module 
der sektoralen Identity Provider eine eindeutige "kk_app_id" vergeben.]]></description>
    <description_html><![CDATA[Der Anbieter des IDP-Dienstes MUSS für alle registrierten Authenticator-Module der sektoralen Identity Provider eine eindeutige &quot;kk_app_id&quot; vergeben.]]></description_html>
  </requirement>
  <requirement id="A_20434" type="leafRequirement" severity="MUSS" lastUpdate="2020-10-08" technicalID="ML-110625" revision="426785">
    <title><![CDATA[Einhaltung der Standards bei der Realisierung des Authorization-Endpunkts]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS die Schnittstelle „Authorization-Endpunkt“ gemäß [RFC6749 
"The OAuth 2.0 Authorization Framework"] und [RFC8252 „OAuth 2.0 for Native 
Apps“] und weiteren darin festgelegten Standards implementieren.]]></description>
    <description_html><![CDATA[<span style="font-weight: normal;">Der IdP-Dienst MUSS die Schnittstelle „Authorization-Endpunkt“ gemäß [RFC6749 &quot;The OAuth 2.0 Authorization Framework&quot;] und [RFC8252 „OAuth 2.0 for Native Apps“] und weiteren darin festgelegten Standards implementieren.</span>]]></description_html>
  </requirement>
  <requirement id="A_19863" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-13" technicalID="ML-107603" revision="426785">
    <title><![CDATA[Schutz vor überalterter Software (Apple)]]></title>
    <description><![CDATA[Der Anbieter IdP-Dienst MUSS dafür Sorge tragen, dass die im Apple App Store 
veröffentlichte Software bei Änderungen automatisiert aktualisiert wird, sodass 
jederzeit die dauerhafte Verwendung fehlerhafter Software ausgeschlossen werden 
kann.]]></description>
    <description_html><![CDATA[Der Anbieter IdP-Dienst <span style="font-weight: normal;">MUSS</span> dafür Sorge tragen, dass die im Apple App Store veröffentlichte Software bei Änderungen automatisiert aktualisiert wird, sodass jederzeit die dauerhafte Verwendung fehlerhafter Software ausgeschlossen werden kann.]]></description_html>
  </requirement>
  <requirement id="A_19865" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-13" technicalID="ML-107601" revision="426785">
    <title><![CDATA[Schutz vor überalterter Software (Android)]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS dafür Sorge tragen, dass die im Google Play 
Store veröffentlichte Software bei Änderungen automatisiert aktualisiert wird, 
sodass jederzeit die dauerhafte Verwendung fehlerhafter Software ausgeschlossen 
werden kann.]]></description>
    <description_html><![CDATA[Der Anbieter des IdP-Dienstes <span style="font-weight: normal;">MUSS </span>dafür Sorge tragen, dass die im Google Play Store veröffentlichte Software bei Änderungen automatisiert aktualisiert wird, sodass jederzeit die dauerhafte Verwendung fehlerhafter Software ausgeschlossen werden kann.]]></description_html>
  </requirement>
  <requirement id="A_21315-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117524" revision="426785">
    <title><![CDATA[Bereitstellung einer URI zum Einreichen von SSO_TOKEN]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS für den Authorization-Endpunkt eine zusätzliche Adresse mit 
der URI-Bezeichnung "sso_endpoint" anbieten, über den im Authorization Code 
Flow (openid-connect-core-1_0 # CodeFlowAuth 
<https://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth>) ein 
Client einen "SSO_TOKEN" einliefern kann, um einen "AUTHORIZATION_CODE" zu 
erhalten.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS für den Authorization-Endpunkt eine zusätzliche Adresse mit der URI-Bezeichnung &quot;sso_endpoint&quot; anbieten, über den im Authorization Code Flow (<a class="descriptionLink" target="_top" href="https://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth">openid-connect-core-1_0 # CodeFlowAuth</a>) ein Client einen &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&quot; einliefern kann, um einen &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>&quot; zu erhalten.]]></description_html>
  </requirement>
  <requirement id="A_20698" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-09" technicalID="ML-111907" revision="426785">
    <title><![CDATA[Annahme des Authorization Request]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS die im Authorization Request des 
Authenticator-Moduls mitgelieferten "CODE_CHALLENGE" und den "SCOPE" annehmen.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS die im Authorization Request des Authenticator-Moduls mitgelieferten &quot;<span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span>&quot; und den &quot;<span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">SCOPE</span>&quot; annehmen.]]></description_html>
  </requirement>
  <requirement id="A_20376" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-09" technicalID="ML-110501" revision="426785">
    <title><![CDATA[Verwendung des Attributes "state"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS den vom Anwendungsfrontend initierten 
"state"-Parameter gemäß [RFC6749 # section-10.12 
<https://tools.ietf.org/html/rfc6749#section-10.12>] bei einer Redirection an 
den Client in seiner Antwort verwenden.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS den vom Anwendungsfrontend initierten &quot;state&quot;-Parameter gemäß [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc6749#section-10.12">RFC6749 # section-10.12</a>] bei einer Redirection an den Client in seiner Antwort verwenden.]]></description_html>
  </requirement>
  <requirement id="A_20731" type="leafRequirement" severity="MUSS" lastUpdate="2020-10-08" technicalID="ML-111990" revision="426785">
    <title><![CDATA[Verwendung des Attributes "auth_time"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS den Parameter "auth_time" mit dem Zeitpunkt der 
letzten Authentisierung gegen das zugelassene Authentifizierungsmittel (z.B.
Auslösen der Signatur durch Smartcard in freigeschaltetem Zustand) setzen.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt <span style="font-weight: normal;">MUSS</span> den Parameter <span style="font-weight: normal;font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;color: #000000;">&quot;auth_time&quot;</span> mit dem Zeitpunkt der letzten Authentisierung gegen das zugelassene Authentifizierungsmittel (z.B. <span style="font-size: 10pt;line-height: 1.5;">Auslösen der Signatur durch Smartcard in freigeschaltetem Zustand</span>) setzen.]]></description_html>
  </requirement>
  <requirement id="A_20440-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117450" revision="426785">
    <title><![CDATA[Schematische Prüfung des Consent]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS die bei der organisatorischen Registrierung der App 
hinterlegten redirect_uri mit der redirect_uri aus dem Claim des 
"CHALLENGE_TOKEN" prüfen. Stimmen diese nicht überein, werden keine Token 
ausgestellt und die weitere Verarbeitung mit einem Fehler Response abgebrochen 
(vgl. https://openid.net/specs/openid-connect-core-1_0.html#AuthError).]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS die bei der organisatorischen Registrierung der App hinterlegten redirect_uri mit der redirect_uri aus dem Claim des &quot;CHALLENGE_TOKEN&quot; prüfen. Stimmen diese nicht überein, werden keine Token ausgestellt und die weitere Verarbeitung mit einem Fehler Response abgebrochen (vgl. https://openid.net/specs/openid-connect-core-1_0.html#AuthError).]]></description_html>
  </requirement>
  <requirement id="A_20459" type="leafRequirement" severity="DARF NICHT" lastUpdate="2020-10-08" technicalID="ML-110664" revision="426785">
    <title><![CDATA[Das Attribut AUTH_TIME muss in allen Token unverändert bleiben]]></title>
    <description><![CDATA[Der Authorization-Endpunkt DARF den Zeitpunkt der letzten Authentisierung im 
Attribut"auth_time" NICHT verändern.]]></description>
    <description_html><![CDATA[<span style="font-weight: normal;">Der Authorization-Endpunkt DARF den Zeitpunkt der letzten Authentisierung im Attribut <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;auth_time&quot;</span> NICHT verändern.</span>]]></description_html>
  </requirement>
  <requirement id="A_20699-03" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-117841" revision="426785">
    <title><![CDATA[Annahme von CHALLENGE_TOKEN: Authentication_Data-Struktur]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS 

 * entweder das mit dem Zertifikat der Smartcard des Nutzers signierte und 
durch das Authenticator-Modul mittels PuK_IDP_ENC verschlüsselte 
"CHALLENGE_TOKEN"
 * oder – im Fall der Verwendung von alternativen Authentisierungsmitteln – 
die mit dem privaten Schlüssel des Endgeräts signierte und durch das 
Authenticator-Modul mittels PuK_IDP_ENC verschlüsselte 
Authentication_Data-Strukturannehmen. Er MUSS in beiden Fällen anhand des im 
Header vorhandenen "exp"-Claim die Token anhand der Systemzeit auf zeitliche 
Gültigkeit prüfen. Sind diese nicht mehr gültig, MUSS der 
Authentifizierungsvorgang abgebrochen werden. Im Fall der Gültigkeit MÜSSEN 
diese mit dem PrK.IDP.ENC entschlüsselt werden.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS <br/> <ul><li>entweder das mit dem Zertifikat der Smartcard des Nutzers signierte und durch das Authenticator-Modul mittels PuK_IDP_ENC verschlüsselte &quot;CHALLENGE_TOKEN&quot;</li><li>oder – im Fall der Verwendung von alternativen Authentisierungsmitteln – die mit dem privaten Schlüssel des Endgeräts signierte und durch das Authenticator-Modul mittels PuK_IDP_ENC verschlüsselte Authentication_Data-Struktur</li></ul>annehmen. Er MUSS in beiden Fällen anhand des im Header vorhandenen &quot;exp&quot;-Claim die Token anhand der Systemzeit auf zeitliche Gültigkeit prüfen. Sind diese nicht mehr gültig, MUSS der Authentifizierungsvorgang abgebrochen werden. Im Fall der Gültigkeit MÜSSEN diese mit dem PrK.IDP.ENC entschlüsselt werden.]]></description_html>
  </requirement>
  <requirement id="A_20951-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-114487" revision="426785">
    <title><![CDATA[Validierung der Signatur und des Zertifikats des CHALLENGE_TOKEN]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS die Signatur des vom Authenticator-Modul 
übertragenen, signierten CHALLENGE_TOKEN anhand des mitgelieferten 
Authentifizierungs-Zertifikats überprüfen. Die Überprüfung MUSS neben der 
Signatur auch das Authentifizierungszertifikat anhand von OCSP umfassen.]]></description>
    <description_html><![CDATA[<span style="font-family: Arial, Helvetica;">Der Authorization-Endpunkt MUSS die Signatur des vom Authenticator-Modul übertragenen, signierten</span> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> <span style="font-family: Arial, Helvetica;">anhand des mitgelieferten Authentifizierungs-Zertifikats überprüfen. Die Überprüfung MUSS neben der Signatur auch das Authentifizierungszertifikat anhand von OCSP umfassen.</span>]]></description_html>
  </requirement>
  <requirement id="A_22328" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-125078" revision="426785">
    <title><![CDATA[IDP-Dienst: Überprüfung der korrekten keyUsage des AUT-Zertifikats]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS die Werte der Attribute "KeyUsage" und "ExtendedKeyUsage" 
des AUT-Zertifikats des vom Authenticator-Moduls gelieferten Response der 
Challenge prüfen und eine weitere Verarbeitung verweigern, wenn nicht die 
folgenden vorgesehenen Werte - neben möglichen weiteren Werten - enthalten sind:
 intendedKeyUsage = digitalSignature;
 intendedExtendedKeyUsage = id-kp-clientAuth.
 Die Nutzung des Attributs "ExtendedKeyUsage" ist optional, weshalb der 
IDP-Dienst die Überprüfung des Wertes des Attributs "ExtendedKeyUsage" nur 
durchführen muss, wenn das Attribut auch vorhanden ist. Ein generelles Fehlen 
des Attributs "ExtendedKeyUsage" führt nicht zur Ablehnung.]]></description>
    <description_html><![CDATA[Der IDP-Dienst MUSS die Werte der Attribute &quot;KeyUsage&quot; und &quot;ExtendedKeyUsage&quot; des AUT-Zertifikats des vom Authenticator-Moduls gelieferten Response der Challenge prüfen und eine weitere Verarbeitung verweigern, wenn nicht die folgenden vorgesehenen Werte - neben möglichen weiteren Werten - enthalten sind:<br/>
intendedKeyUsage = digitalSignature;<br/>
intendedExtendedKeyUsage = id-kp-clientAuth.<br/>
Die Nutzung des Attributs &quot;ExtendedKeyUsage&quot; ist optional, weshalb der IDP-Dienst die Überprüfung des Wertes des Attributs &quot;ExtendedKeyUsage&quot; nur durchführen muss, wenn das Attribut auch vorhanden ist. Ein generelles Fehlen des Attributs &quot;ExtendedKeyUsage&quot; führt nicht zur Ablehnung. <span id="polarion-comment:1604"></span>]]></description_html>
  </requirement>
  <requirement id="A_20946-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-07-09" technicalID="ML-117453" revision="426785">
    <title><![CDATA[Annahme eines "SSO_TOKEN"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS einen vom Autenticator-Modul übertragenen "
SSO_TOKEN" annehmen, sofern anhand der übertragenen "client_id" festgestellt 
wird, dass im Registrierungsprozess für diese "client_id" die Verwendung eines "
SSO_TOKEN" hinterlegt wurde. Ansonsten MUSS der IdP-Dienst die Verarbeitung mit 
einer Fehlermeldung abbrechen.]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der Authorization-Endpunkt MUSS einen vom Autenticator-Modul übertragenen &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&quot; annehmen, sofern anhand der übertragenen &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span>&quot; festgestellt wird, dass im Registrierungsprozess für diese &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span>&quot; die Verwendung eines &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&quot; hinterlegt wurde. Ansonsten MUSS der IdP-Dienst die Verarbeitung mit einer Fehlermeldung abbrechen.</span><br/>]]></description_html>
  </requirement>
  <requirement id="A_20947" type="leafRequirement" severity="MUSS" lastUpdate="2020-11-12" technicalID="ML-112824" revision="426785">
    <title><![CDATA[Entschlüsselung des "SSO_TOKEN"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS den angenommenen "SSO_TOKEN" mit seinem eigenen 
Schlüsselmaterial, welches zur Verschlüsselung genutzt wurde, entschlüsseln.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS den angenommenen &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&quot; mit seinem eigenen Schlüsselmaterial, welches zur Verschlüsselung genutzt wurde, entschlüsseln.]]></description_html>
  </requirement>
  <requirement id="A_20948-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-117407" revision="426785">
    <title><![CDATA[Validierung des "SSO_TOKEN"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS den angenommenen und entschlüsselten "SSO_TOKEN
" validieren. Die Validierung MUSS die Überprüfung der Signatur anhand seines 
öffentlichen Schlüssels PuK_IDP_SIG und die Überprüfung der zeitlichen 
Gültigkeit des "SSO_TOKEN" anhand des Attributs "auth_time" umfassen.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS den angenommenen und entschlüsselten &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&quot; validieren. Die Validierung MUSS die Überprüfung der Signatur anhand seines öffentlichen Schlüssels PuK_IDP_SIG und die Überprüfung der zeitlichen Gültigkeit des &quot;SSO_TOKEN&quot; anhand des Attributs &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">auth_time</span>&quot; umfassen.]]></description_html>
  </requirement>
  <requirement id="A_20949" type="leafRequirement" severity="MUSS" lastUpdate="2020-11-12" technicalID="ML-112827" revision="426785">
    <title><![CDATA[Anforderung einer Authentisierung bei negativer Validierung des "SSO_TOKEN"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS eine neue Authentisierung vom 
Authenticator-Modul anfordern, wenn die Validierung des vom 
Authenticator-Moduls eingereichten "SSO_TOKEN" fehlschlägt.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS eine neue Authentisierung vom Authenticator-Modul anfordern, wenn die Validierung des vom Authenticator-Moduls eingereichten &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&quot; fehlschlägt.]]></description_html>
  </requirement>
  <requirement id="A_20950-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117451" revision="426785">
    <title><![CDATA[Positive Validierung des "SSO_TOKEN"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS bei der positiven Validierung des vom 
Authenticator-Moduls eingereichten "SSO_TOKEN" einen "AUTHORIZATION_CODE" für 
den angefragten Fachdienst ausstellen.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS bei der positiven Validierung des vom Authenticator-Moduls eingereichten &quot;SSO_TOKEN&quot; einen &quot;AUTHORIZATION_CODE&quot; für den angefragten Fachdienst ausstellen.]]></description_html>
  </requirement>
  <requirement id="A_20522" type="leafRequirement" severity="MUSS" lastUpdate="2020-10-08" technicalID="ML-110797" revision="426785">
    <title><![CDATA[Erstellen einer "SESSION_ID"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS eine neue "SESSION_ID" anlegen, sobald ein 
Authorization Request eingeht.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS eine neue &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SESSION_ID</span>&quot; anlegen, sobald ein Authorization Request eingeht.]]></description_html>
  </requirement>
  <requirement id="A_20523" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-09" technicalID="ML-110798" revision="426785">
    <title><![CDATA[Zusammenstellung der Claims zum "user_consent"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS die für den vorgetragenen "SCOPE" vom 
einfordernden Fachdienst erwarteten Claims zur"USER_CONSENT"-Anfrage 
zusammenstellen.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS die für den vorgetragenen <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;SCOPE&quot;</span> vom einfordernden Fachdienst erwarteten Claims zur <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;USER_CONSENT&quot;</span>-Anfrage zusammenstellen.]]></description_html>
  </requirement>
  <requirement id="A_20313-01" type="leafRequirement" severity="MUSS" lastUpdate="2022-07-13" technicalID="ML-114496" revision="478712">
    <title><![CDATA[Inhalte des Claims]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS ID_TOKEN und ACCESS_TOKEN für unterschiedliche Fachdienste 
gemäß den mit dem jeweiligen Fachdienst abgestimmten Claims bereitstellen.

 Sind Inhalte des Claims teilweise oder das gesamte Claim für einen 
registrierten Fachdienst nicht gesetzt, befüllt der IDP-Dienst die einzelnen 
Parameter der Gültigkeitsdauer für ACCESS_TOKEN und ID_TOKEN gemäß der 
spezifizierten Maximalwerte]]></description>
    <description_html><![CDATA[Der IDP-Dienst MUSS <span style="font-weight: bold;font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;"></span><span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">ID_TOKEN</span><span style="font-weight: bold;font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;"></span> und <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> für unterschiedliche Fachdienste gemäß den mit dem jeweiligen Fachdienst abgestimmten Claims bereitstellen. <br/>
 <br/>
Sind Inhalte des Claims teilweise oder das gesamte Claim für einen registrierten Fachdienst nicht gesetzt, befüllt der IDP-Dienst die einzelnen Parameter der Gültigkeitsdauer für <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">ID_TOKEN</span> gemäß der spezifizierten Maximalwerte]]></description_html>
  </requirement>
  <requirement id="A_20692-01" type="leafRequirement" severity="DARF NICHT" lastUpdate="2021-12-15" technicalID="ML-114495" revision="426785">
    <title><![CDATA[Maximale Gültigkeitsdauer eines SSO_TOKEN]]></title>
    <description><![CDATA[Der Authorization Server DARF die zeitliche Gültigkeit eines SSO_TOKEN NICHT 
länger als 86400 Sekunden (24 Stunden) einstellen.
Der Parameter "auth_time" beinhaltet den Zeitpunkt der letzten Authentisierung.]]></description>
    <description_html><![CDATA[Der Authorization Server DARF die zeitliche Gültigkeit eines SSO_TOKEN NICHT länger als 86400 Sekunden (24 Stunden) einstellen.<br/>Der Parameter <span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;</span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">auth_time</span><span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;</span> beinhaltet den Zeitpunkt der letzten Authentisierung.]]></description_html>
  </requirement>
  <requirement id="A_20314-01" type="leafRequirement" severity="DARF NICHT" lastUpdate="2021-12-15" technicalID="ML-117452" revision="426785">
    <title><![CDATA[Maximale Gültigkeitsdauer des "AUTHORIZATION_CODE" und des "CHALLENGE_TOKEN"]]></title>
    <description><![CDATA[Der Authorization Server DARF die zeitliche Gültigkeit des "CHALLENGE_TOKEN" 
NICHT länger als 180 Sekunden (Challenge-Response) und die des "
AUTHORIZATION_CODE" NICHT länger als 60 Sekunden einstellen.]]></description>
    <description_html><![CDATA[Der Authorization Server DARF die zeitliche Gültigkeit des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;CHALLENGE_TOKEN&quot;</span> NICHT länger als 180 Sekunden (Challenge-Response) und die des &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>&quot; NICHT länger als 60 Sekunden einstellen.]]></description_html>
  </requirement>
  <requirement id="A_20315-01" type="leafRequirement" severity="DARF NICHT" lastUpdate="2021-12-15" technicalID="ML-114501" revision="426785">
    <title><![CDATA["AUTHORIZATION_CODE" nach Gültigkeitsende nicht mehr verwenden]]></title>
    <description><![CDATA[Der Token-Endpunkt DARF außerhalb der Gültigkeitsdauer eingehenden 
"AUTHORIZATION_CODE" NICHT in "ID_TOKEN" oder "ACCESS_TOKEN" eintauschen.]]></description>
    <description_html><![CDATA[Der Token-Endpunkt DARF <span style="font-size: 10pt;line-height: 1.5;">außerhalb der Gültigkeitsdauer </span>eingehenden <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;AUTHORIZATION_CODE&quot;</span> NICHT in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;ID_TOKEN&quot;</span> oder <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;ACCESS_TOKEN&quot;</span> eintauschen.]]></description_html>
  </requirement>
  <requirement id="A_20462" type="leafRequirement" severity="DARF NICHT" lastUpdate="2020-10-08" technicalID="ML-110667" revision="426785">
    <title><![CDATA[Maximale Gültigkeitsdauer des "ID_TOKEN"]]></title>
    <description><![CDATA[Der Token-Endpunkt DARF "ID_TOKEN" mit einer Gültigkeitsdauer von mehr als 86400
Sekunden (24 Stunden) NICHT ausstellen.]]></description>
    <description_html><![CDATA[Der Token-Endpunkt DARF <span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;</span><span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">ID_TOKEN&quot;</span> mit einer Gültigkeitsdauer <span style="font-weight: normal;">von mehr</span> als 86400 <span style="font-weight: normal;">Sekunden (24 Stunden)</span> NICHT ausstellen.]]></description_html>
  </requirement>
  <requirement id="A_20463" type="leafRequirement" severity="DARF NICHT" lastUpdate="2020-11-12" technicalID="ML-110668" revision="426785">
    <title><![CDATA[Maximale Gültigkeitsdauer des "ACCESS_TOKEN"]]></title>
    <description><![CDATA[Der Token-Endpunkt DARF "ACCESS_TOKEN" mit einer Gültigkeitsdauer von mehr als 
300Sekunden (5 Minuten) NICHT ausstellen.]]></description>
    <description_html><![CDATA[Der Token-Endpunkt DARF <span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;</span><span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">ACCESS_TOKEN</span><span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;</span> <span style="font-weight: normal;">mit einer Gültigkeitsdauer von mehr</span> als 300 <span style="font-weight: normal;">Sekunden (5 Minuten)</span> NICHT ausstellen.]]></description_html>
  </requirement>
  <requirement id="A_20464" type="leafRequirement" severity="DARF NICHT" lastUpdate="2020-10-08" technicalID="ML-110669" revision="426785">
    <title><![CDATA[Token-Endpunkt (Datensparsamkeit)]]></title>
    <description><![CDATA[Der Token-Endpunkt DARF andere Informationen, als die im Claim geforderten, 
NICHT herausgeben.]]></description>
    <description_html><![CDATA[Der Token-Endpunkt <span style="font-weight: normal;">DARF andere Informationen, als die im Claim geforderten, NICHT </span>herausgeben.]]></description_html>
  </requirement>
  <requirement id="A_20318" type="leafRequirement" severity="DARF NICHT" lastUpdate="2020-11-12" technicalID="ML-110428" revision="426785">
    <title><![CDATA[Keine Token für widerrufene Entitäten]]></title>
    <description><![CDATA[Der Authorization-Endpunkt DARF für nicht existente Entitäten NICHT einen "
AUTHORIZATION_CODE", einen "ID_TOKEN", einen "ACCESS_TOKEN" oder einen "
SSO_TOKEN" auszustellen. ]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt DARF für nicht existente Entitäten NICHT einen <span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;</span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION</span><span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">_CODE</span><span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;,</span> einen <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;ID_TOKEN&quot;</span>, einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;ACCESS_TOKEN&quot;</span> oder einen <span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;</span><span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span><span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;</span> auszustellen. ]]></description_html>
  </requirement>
  <requirement id="A_20465" type="leafRequirement" severity="MUSS" lastUpdate="2020-11-12" technicalID="ML-110670" revision="426785">
    <title><![CDATA[Zertifikatsprüfung gegen OCSP-Responder]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS das Zertifikat des Antragstellers immer gegen 
den zugehörigen OCSP-Responder innerhalb der TI auf Gültigkeit prüfen.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS das Zertifikat des Antragstellers immer gegen den zugehörigen OCSP-Responder innerhalb der TI auf Gültigkeit prüfen.]]></description_html>
  </requirement>
  <requirement id="A_22290" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-125012" revision="426785">
    <title><![CDATA[Zwischenspeichern (Caching) von Smartcard-basierten OCSP-Antworten]]></title>
    <description><![CDATA[Der Produkttyp IDP MUSS OCSP-Antworten zu Gültigkeitsanfragen für 
Smartcard-basierte Zertifikate zwischenspeichern und bei einer erneuten Prüfung 
desselben Zertifikates anstelle einer neuen OCSP-Anfrage diese 
zwischengespeicherte Information verwenden.
 Die Informationen MÜSSEN jeweils für einen konfigurierbaren Zeitraum (von 
maximal 60 Minuten) gespeichert werden.
 Voreingestellt sind 30 Minuten.
 Der TUC_PKI_006 und der eingebaute Cache des OCSP-Responder sind hierbei zu 
berücksichtigen.]]></description>
    <description_html><![CDATA[Der Produkttyp IDP MUSS OCSP-Antworten zu Gültigkeitsanfragen für <span style="font-size: 10pt;line-height: 1.5;">Smartcard-basierte </span>Zertifikate zwischenspeichern und bei einer erneuten Prüfung desselben Zertifikates anstelle einer neuen OCSP-Anfrage diese zwischengespeicherte Information verwenden. <br/>
Die Informationen MÜSSEN jeweils für einen konfigurierbaren Zeitraum <span style="font-size: 10pt;line-height: 1.5;">(von maximal 60 Minuten) </span>gespeichert werden.<br/>
Voreingestellt sind 30 Minuten.<br/>
Der TUC_PKI_006 und der eingebaute Cache des OCSP-Responder sind hierbei zu berücksichtigen. <span id="polarion-comment:1611"></span>]]></description_html>
  </requirement>
  <requirement id="A_20521-02" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-114486" revision="426785">
    <title><![CDATA[Inhalt des CHALLENGE_TOKEN an das Authenticator-Modul]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS die ihm vorliegenden Session-Informationen (z.B. "SESSION_ID
", "CODE_CHALLENGE", "SCOPE" und alle Informationen über Anwendungsfrontend und 
Authenticator-Modul) mit seinem privaten Schlüssel "PrK_IDP_SIG" und der 
technischen Rolle „oid_idpd“ gemäß [gemSpec_OID # Abschnitt 3.5.4] signieren 
und als JWT ergänzt um die "USER_CONSENT"-Anfrage an das Authenticator-Modul 
senden. Als Algorithmus ist dementsprechend "BP256R1" zu wählen.]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der IdP-Dienst MUSS die ihm vorliegenden Session-Informationen (z.B. &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SESSION_ID</span>&quot;, &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span>&quot;, &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SCOPE</span>&quot; und alle Informationen über Anwendungsfrontend und Authenticator-Modul) mit seinem privaten Schlüssel &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_SIG</span>&quot; und der technischen Rolle „oid_idpd“ gemäß [gemSpec_OID # Abschnitt 3.5.4] signieren und als JWT ergänzt um die &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">USER_CONSENT</span>&quot;-Anfrage an das Authenticator-Modul senden. Als Algorithmus ist dementsprechend &quot;BP256R1&quot; zu wählen.</span>]]></description_html>
  </requirement>
  <requirement id="A_20377" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-09" technicalID="ML-110502" revision="426785">
    <title><![CDATA[Verwendung des Attributes "state"]]></title>
    <description><![CDATA[Der Authroization-Endpunkt MUSS den "state"-Parameter [RFC6749 # section-10.12 
<https://tools.ietf.org/html/rfc6749#section-10.12>] des Anwendungsfrontends in 
allen darauf basierenden Responses verwenden.]]></description>
    <description_html><![CDATA[Der Authroization-Endpunkt MUSS den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;state&quot;</span>-Parameter [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc6749#section-10.12">RFC6749 # section-10.12</a>] des Anwendungsfrontends in allen darauf basierenden Responses verwenden.]]></description_html>
  </requirement>
  <requirement id="A_20694" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-09" technicalID="ML-111903" revision="426785">
    <title><![CDATA[Zusammenstellung des "SSO_TOKEN"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS den "SSO_TOKEN" so zusammenstellen, dass alle 
Informationen, welche für die Ausstellung eines neuen "ACCESS_TOKEN" benötigt 
werden, im Token vorhanden sind.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS den &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&quot; so zusammenstellen, dass alle Informationen, welche für die Ausstellung eines neuen &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>&quot; benötigt werden, im Token vorhanden sind.]]></description_html>
  </requirement>
  <requirement id="A_20695-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-117405" revision="426785">
    <title><![CDATA[Signieren des "SSO_TOKEN"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS den "SSO_TOKEN" mit seinem eigenen privaten 
Schlüssel "PrK_IDP_SIG" signieren. Als Algorithmus ist dementsprechend 
"BP256R1" zu wählen.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS den &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&quot; mit seinem eigenen privaten Schlüssel &quot;PrK_IDP_SIG&quot; signieren. Als Algorithmus ist dementsprechend &quot;BP256R1&quot; zu wählen.]]></description_html>
  </requirement>
  <requirement id="A_20696" type="leafRequirement" severity="MUSS" lastUpdate="2020-11-12" technicalID="ML-111905" revision="426785">
    <title><![CDATA[Verschlüsselung des "SSO_TOKEN"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt verschlüsselt den "SSO_TOKEN" für sich selbst mit 
eigenem Schlüsselmaterial, welches die gemSpec_Krypt beachtet.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt verschlüsselt den &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&quot; für sich selbst mit eigenem Schlüsselmaterial, welches die gemSpec_Krypt beachtet.]]></description_html>
  </requirement>
  <requirement id="A_20697" type="leafRequirement" severity="MUSS" lastUpdate="2020-10-08" technicalID="ML-111906" revision="426785">
    <title><![CDATA[Zusammenstellung des "AUTHORIZATION_CODE"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt erzeugt den "AUTHORIZATION_CODE" anhand der vom 
Authenticator-Modul übergebenen Daten im "CHALLENGE".]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt erzeugt den &quot;<span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>&quot; anhand der vom Authenticator-Modul übergebenen Daten im &quot;<span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">CHALLENGE</span>&quot;.]]></description_html>
  </requirement>
  <requirement id="A_21317" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116334" revision="426785">
    <title><![CDATA[Verschlüsselung des "AUTHORIZATION_CODE"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt des IdP-Dienstes MUSS den "AUTHORIZATION_CODE" für 
den Token-Endpunkt mit eigenem Schlüsselmaterial verschlüsseln, welches den 
Anforderungen aus [gemSpec_Krypt] genügt.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt des IdP-Dienstes MUSS den &quot;AUTHORIZATION_CODE&quot; für den Token-Endpunkt mit eigenem Schlüsselmaterial verschlüsseln, welches den Anforderungen aus [gemSpec_Krypt] genügt.]]></description_html>
  </requirement>
  <requirement id="A_20319-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117510" revision="426785">
    <title><![CDATA[Signatur des "AUTHORIZATION_CODE"]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS den "AUTHORIZATION_CODE" für die Authentisierung mit einem 
Zertifikat des Typs FD.SIG und der technischen Rolle „oid_idpd“ gemäß 
[gemSpec_OID # Abschnitt 3.5.4] signieren, damit das Authenticator-Modul sicher 
gewährleisten kann, dass der eingehende"AUTHORIZATION_CODE" tatsächlich vom 
IdP-Dienst stammt [RFC7519 # section-7.1 
<https://tools.ietf.org/html/rfc7519#section-7.1>].]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS den &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>&quot; für die Authentisierung mit einem Zertifikat des Typs FD.SIG und der technischen Rolle „oid_idpd“ gemäß [gemSpec_OID # Abschnitt 3.5.4] signieren, damit das Authenticator-Modul sicher gewährleisten kann, dass der eingehende <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;AUTHORIZATION_CODE&quot; </span>tatsächlich vom IdP-Dienst stammt [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7519#section-7.1">RFC7519 # section-7.1</a>].]]></description_html>
  </requirement>
  <requirement id="A_21330" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116366" revision="426785">
    <title><![CDATA[Ablaufzeitpunkt von "AUTHORIZATION_CODE" und "SSO_TOKEN"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt des IdP-Dienstes MUSS im "exp"-Claim des jeweiligen 
JWE Headers den Ablaufzeitpunkt des "AUTHORIZATION_CODE" bzw. "SSO_TOKEN" 
liefern.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt des IdP-Dienstes MUSS im &quot;exp&quot;-Claim des jeweiligen JWE Headers den Ablaufzeitpunkt des &quot;AUTHORIZATION_CODE&quot; bzw. &quot;SSO_TOKEN&quot; liefern.]]></description_html>
  </requirement>
  <requirement id="A_20693-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-07-06" technicalID="ML-114465" revision="426785">
    <title><![CDATA[Senden des "AUTHORIZATION_CODE" und "SSO_TOKEN" an die "REDIRECT_URI"]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS den "AUTHORIZATION_CODE" und die registrierte "REDIRECT_URI
" an das Authenticator-Modul senden. Der IdP-Dienst MUSS zusätzlich einen 
"SSO_TOKEN" mitliefern, wenn die "client_id" im Registrierungsprozess des 
Anwendungsfrontends für die Nutzung eines "SSO_TOKEN" freigeschaltet wurde.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS den &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>&quot; und die registrierte &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">REDIRECT_URI</span>&quot; an das Authenticator-Modul senden. Der IdP-Dienst MUSS zusätzlich einen &quot;SSO_TOKEN&quot; mitliefern, wenn die &quot;client_id&quot; im Registrierungsprozess des Anwendungsfrontends für die Nutzung eines &quot;SSO_TOKEN&quot; freigeschaltet wurde.]]></description_html>
  </requirement>
  <requirement id="A_20320-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-117577" revision="426785">
    <title><![CDATA[Sichere Übertragung des "AUTHORIZATION_CODE"]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS den Transport des "AUTHORIZATION_CODE" über 
unsichere Netze (z.B. Internet) durch Verwendung von Transport Layer Security 
(TLS) gemäß den Vorgaben der [gemSpec_Krypt] sichern [RFC7523 # section-7 
<https://tools.ietf.org/html/rfc7523#section-7>].]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS den Transport des &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>&quot; über unsichere Netze (z.B. Internet) durch Verwendung von Transport Layer Security (TLS) gemäß den Vorgaben der [gemSpec_Krypt] sichern [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7523#section-7">RFC7523 # section-7</a>].]]></description_html>
  </requirement>
  <requirement id="A_20321-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116335" revision="426785">
    <title><![CDATA[Annahme und Prüfung von "AUTHORIZATION_CODE" und "KEY_VERIFIER"]]></title>
    <description><![CDATA[Der Token-Endpunkt MUSS den vom Anwendungsfrontend übertragenen 
"AUTHORIZATION_CODE" und den "KEY_VERIFIER" des Anwendungsfrontend annehmen. 
Der "AUTHORIZATION_CODE" ist dabei mittels eines durch den IdP-Dienst für 
Authorization-Endpunkt und Token-Endpunkt definierten Verfahren zu 
entschlüsseln. ]]></description>
    <description_html><![CDATA[Der Token-Endpunkt MUSS den vom Anwendungsfrontend übertragenen &quot;AUTHORIZATION_CODE&quot; und den &quot;KEY_VERIFIER&quot; des Anwendungsfrontend annehmen. Der &quot;AUTHORIZATION_CODE&quot; ist dabei mittels eines durch den IdP-Dienst für Authorization-Endpunkt und Token-Endpunkt definierten Verfahren zu entschlüsseln. ]]></description_html>
  </requirement>
  <requirement id="A_21318" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116336" revision="426785">
    <title><![CDATA[Prüfung des "AUTHORIZATION_CODE“]]></title>
    <description><![CDATA[Der Token-Endpunkt MUSS die Signatur des "AUTHORIZATION_CODE“ unter Verwendung 
des Schlüssels PuK_IDP_SIG prüfen.]]></description>
    <description_html><![CDATA[Der Token-Endpunkt MUSS die Signatur des &quot;AUTHORIZATION_CODE“ unter Verwendung des Schlüssels PuK_IDP_SIG prüfen.]]></description_html>
  </requirement>
  <requirement id="A_21319" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116337" revision="426785">
    <title><![CDATA[Prüfung des "CODE_VERIFIER"]]></title>
    <description><![CDATA[Der Token-Endpunkt MUSS den "CODE_VERIFIER" aus dem mittels PuK_IDP_ENC 
verschlüsselten "KEY_VERIFIER" extrahieren und die Überprüfung gegen die 
"CODE_CHALLENGE" mit S256 (Algorithmus nach [RFC7636 # section-4.2 
<https://tools.ietf.org/html/rfc7636#section-4.2>]) durchführen.]]></description>
    <description_html><![CDATA[Der Token-Endpunkt MUSS den &quot;CODE_VERIFIER&quot; aus dem mittels PuK_IDP_ENC verschlüsselten &quot;KEY_VERIFIER&quot; extrahieren und die Überprüfung gegen die &quot;CODE_CHALLENGE&quot; mit S256 (Algorithmus nach [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7636#section-4.2">RFC7636 # section-4.2</a>]) durchführen.]]></description_html>
  </requirement>
  <requirement id="A_21320" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116338" revision="426785">
    <title><![CDATA[Entschlüsseln des "Token-Key"]]></title>
    <description><![CDATA[Der Token-Endpunkt MUSS den "Token-Key" aus dem mittels PuK_IDP_ENC 
verschlüsselten "KEY_VERIFIER" extrahieren.]]></description>
    <description_html><![CDATA[Der Token-Endpunkt MUSS den &quot;Token-Key&quot; aus dem mittels PuK_IDP_ENC verschlüsselten &quot;KEY_VERIFIER&quot; extrahieren.<span id="polarion-comment:1531"></span>]]></description_html>
  </requirement>
  <requirement id="A_21309" type="leafRequirement" severity="KANN" lastUpdate="2021-12-15" technicalID="ML-116314" revision="426785">
    <title><![CDATA[Prüfung der Verwendung des Authorization Codes]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes KANN gegen [RFC6749 # section-10.5 
<https://tools.ietf.org/html/rfc6749#section-10.5>] verstoßen, indem der 
IdP-Dienst nicht die einmalige Verwendung eines "AUTHORIZATION_CODE" überprüft. 
Die kurze Gültigkeit und die Verschlüsselung der ausgestellten Token wird als 
ausreichend sicher betrachtet.]]></description>
    <description_html><![CDATA[Der Anbieter des IdP-Dienstes KANN gegen [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc6749#section-10.5">RFC6749 # section-10.5</a>] verstoßen, indem der IdP-Dienst nicht die einmalige Verwendung eines &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>&quot; überprüft. Die kurze Gültigkeit und die Verschlüsselung der ausgestellten Token wird als ausreichend sicher betrachtet.]]></description_html>
  </requirement>
  <requirement id="A_20323" type="leafRequirement" severity="MUSS" lastUpdate="2020-10-08" technicalID="ML-110434" revision="426785">
    <title><![CDATA[TOKEN-Ausgabe Protokollierung in allen Fällen]]></title>
    <description><![CDATA[Der Token-Endpunkt MUSS die Herausgabe der "TOKEN" im Positiv- wie auch im 
Negativfall protokollieren.]]></description>
    <description_html><![CDATA[Der Token-Endpunkt <span style="font-weight: normal;">MUSS</span> die Herausgabe der <span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;</span><span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">TOKEN</span><span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;</span> im Positiv- wie auch im Negativfall protokollieren.]]></description_html>
  </requirement>
  <requirement id="A_20524-04" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-125076" revision="426785">
    <title><![CDATA[Befüllen der Claims "given_name", "family_name", "organizationName", "professionOID", "idNummer", "acr" und "amr"]]></title>
    <description><![CDATA[Der Token-Endpunkt MUSS benötigte Attribute in Claims für das auszustellende 
"ACCESS_TOKEN" und das "ID_TOKEN" ausschließlich aus dem ihm mit dem signierten 
CHALLENGE_TOKEN eingereichten Authentifizierungszertifikat der Smartcard (eGK, 
HBA oder SMC-B) beziehen. Der Claim "amr" MUSS entsprechend des ursprünglich 
zur Authentisierung verwendeten Authentisierungsmittels belegt werden.
 Der Token-Endpunkt MUSS das Attribut "given_name" und "family_name" der 
juristischen und natürlichen Personen sowie die Attribute "organizationName", 
"professionOID" und "idNummer" entsprechend des Datenformates der 
Informationsquelle (Zertifikat) wie folgt befüllen:


 Tabelle #: TAB_IDP_DIENST_0005 Befüllung der Attribute "given_name", 
"family_name", "organizationName", "professionOID" und "idNummer" 

Attribute Leistungserbringer (HBA)
 Quell-Zertifikat: C.HP.AUT Leistungserbringerinstitution (SMC-B)
 Quell-Zertifikat: C.HCI.AUT Versicherte (eGK)
 Quell-Zertifikat: C.CH.AUT 
Attribute "given_name"
 (Zertifikatsfeld) Vorname
 (givenName) Vorname des Verantwortlichen/Inhabers
 givenName) Vorname
 (givenName) 
Attribute "family_name"
(Zertifikatsfeld) Nachname
 (surname) Nachname des Verantwortlichen/Inhabers
 (surname) Nachname
 (surname) 
Attribute "organizationName"
(Zertifikatsfeld) leer
 (organizationName) Organisationsbezeichnung
 (commonName)  Herausgeber
 (organizationName) 
Attribute "professionOID"
(Zertifikatsfeld) professionOID
 (Admission/professionOID) professionOID
 (Admission/professionOID) professionOID
 (Admission/professionOID) 
Identifier "idNummer"
 (Zertifikatsfeld) Telematik-ID
 (Admission/
 registrationNumber) Telematik-ID
 (Admission/
 registrationNumber) unveränderlicher Anteil der KVNR
 (organizationalUnitName) 


 Tabelle #: TAB_IDP_DIENST_0006 Befüllung der Attribute "acr" und "amr" 

Attribut Leistungserbringer (HBA) Leistungserbringerinstitution (SMC-B) 
Versicherte (eGK) Versicherte (alternative Authentisierungsmittel) 
Attribut "amr" [„mfa“,“sc“,“pin“] [„mfa“,“sc“,“pin“] [„mfa“,“sc“,“pin“] Gemäß 
des übertragenen Werts des Authenticator-Moduls in der Datenstruktur 
"Signed_Authentication_Data" 
Attribut "acr" gematik-ehealth-loa-high
gematik-ehealth-loa-high
gematik-ehealth-loa-high
gematik-ehealth-loa-high]]></description>
    <description_html><![CDATA[Der Token-Endpunkt MUSS benötigte Attribute in Claims für das auszustellende <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;ACCESS_TOKEN&quot;</span> und das <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;ID_TOKEN&quot;</span> ausschließlich aus dem ihm mit dem <span style="font-family: Arial, Helvetica;">signierten</span> <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> eingereichten Authentifizierungszertifikat der Smartcard (eGK, HBA oder SMC-B) beziehen. Der Claim &quot;amr&quot; MUSS entsprechend des ursprünglich zur Authentisierung verwendeten Authentisierungsmittels belegt werden.<br/>
Der Token-Endpunkt MUSS das Attribut <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;given_name&quot;</span> und <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;family_name&quot;</span> der juristischen und natürlichen Personen sowie die Attribute <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;organizationName&quot;, &quot;professionOID&quot;</span> und <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;idNummer&quot;</span> entsprechend des Datenformates der Informationsquelle (Zertifikat) wie folgt befüllen:<br/>
 <br/>
 
<p data-keep-next="true" class="polarion-rte-caption-paragraph">
  Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">#</span>: TAB_IDP_DIENST_0005 Befüllung der Attribute &quot;given_name&quot;, &quot;family_name&quot;, &quot;organizationName&quot;, &quot;professionOID&quot; und &quot;idNummer&quot;  
</p>
 
<table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;">
  <tbody>
    <tr>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute</th>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Leistungserbringer (HBA)<br/>
        Quell-Zertifikat: C.HP.AUT</th>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Leistungserbringerinstitution (SMC-B)<br/>
        Quell-Zertifikat: C.HCI.AUT</th>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherte (eGK)<br/>
        Quell-Zertifikat: C.CH.AUT</th>
    </tr>
    <tr>
      <td style="width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;given_name&quot;<br/>
          (</span>Zertifikatsfeld<span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">)</span></td>
      <td style="width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Vorname<br/>
        (givenName)</td>
      <td style="width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Vorname des Verantwortlichen/Inhabers<br/>
        givenName)</td>
      <td style="width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Vorname<br/>
        (givenName)</td>
    </tr>
    <tr>
      <td style="width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;family_name&quot;</span><br/>
        <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">(</span>Zertifikatsfeld<span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">)</span></td>
      <td style="width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Nachname<br/>
        (surname)</td>
      <td style="width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Nachname des Verantwortlichen/Inhabers<br/>
        (surname)</td>
      <td style="width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Nachname<br/>
        (surname)</td>
    </tr>
    <tr>
      <td style="width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute &quot;<span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">organizationName</span>&quot;<br/>
        <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">(</span>Zertifikatsfeld<span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">)</span></td>
      <td style="width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">leer<br/>
        (organizationName)</td>
      <td style="width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Organisationsbezeichnung<br/>
        (commonName) <span id="polarion-comment:1608"></span></td>
      <td style="width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Herausgeber<br/>
        (organizationName)</td>
    </tr>
    <tr>
      <td style="width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute &quot;<span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">professionOID</span>&quot;<br/>
        <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">(</span>Zertifikatsfeld<span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">)</span></td>
      <td style="width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">professionOID<br/>
        (Admission/professionOID)</td>
      <td style="width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">professionOID<br/>
        (Admission/professionOID)</td>
      <td style="width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">professionOID<br/>
        (Admission/professionOID)</td>
    </tr>
    <tr>
      <td style="width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Identifier <span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">&quot;idNummer&quot;<br/>
          (</span><span style="font-size: 10pt;line-height: 1.5;">Zertifikatsfeld</span><span style="font-family: &#39;Courier New&#39;, Courier, monospace, HanWangKanTan;">)</span></td>
      <td style="width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Telematik-ID<br/>
        (Admission/<br/>
        registrationNumber)</td>
      <td style="width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Telematik-ID<br/>
        (Admission/<br/>
        registrationNumber)</td>
      <td style="width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">unveränderlicher Anteil der </span>KVNR<br/>
        (organizationalUnitName)</td>
    </tr>
  </tbody>
</table>
 <br/>
 <br/>
 
<p class="polarion-rte-caption-paragraph">
  Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">#</span>: TAB_IDP_DIENST_0006 Befüllung der Attribute &quot;acr&quot; und &quot;amr&quot; 
</p>
 
<table id="polarion_wiki macro name=table;params=width=99.56%" class="polarion-Document-table" style="width: 99.56%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;">
  <tbody>
    <tr>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribut</th>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 184px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Leistungserbringer (HBA)</th>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 203px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Leistungserbringerinstitution (SMC-B)</th>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 207px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherte (eGK)</th>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 466px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherte (alternative Authentisierungsmittel)</th>
    </tr>
    <tr>
      <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribut &quot;amr&quot;</td>
      <td style="width: 184px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[„mfa“,“sc“,“pin“]</td>
      <td style="width: 203px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[„mfa“,“sc“,“pin“]</td>
      <td style="width: 207px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[„mfa“,“sc“,“pin“]</td>
      <td style="width: 466px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Gemäß des übertragenen Werts des Authenticator-Moduls in der Datenstruktur &quot;Signed_Authentication_Data&quot;</td>
    </tr>
    <tr>
      <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribut &quot;acr&quot;</td>
      <td style="width: 184px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik-ehealth-loa-high<br/>
        </td>
      <td style="width: 203px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik-ehealth-loa-high<br/>
        </td>
      <td style="width: 207px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik-ehealth-loa-high<br/>
        </td>
      <td style="width: 466px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik-ehealth-loa-high<br/>
        </td>
    </tr>
  </tbody>
</table>]]></description_html>
  </requirement>
  <requirement id="A_22271" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124978" revision="426785">
    <title><![CDATA[Befüllen der Claims "given_name", "family_name", "organizationName", "professionOID", "idNummer", "acr" und "amr" nach Bestätigung durch einen sektoralen Identity Provider]]></title>
    <description><![CDATA[Der Token-Endpunkt MUSS benötigte Attribute in Claims für das auszustellende 
"ACCESS_TOKEN" und das "ID_TOKEN" ausschließlich aus den entsprechenden Claims 
des ID-Token des sektoralen Identity Provider beziehen.
Der Claim "amr" MUSS entsprechend des ursprünglich zur Authentisierung 
verwendeten Authentisierungsmittels belegt werden.


Tabelle #: TAB_IDP_DIENST_000X Befüllung der Attribute nach Bestätigung durch 
einen sektoralen Identity Provider

AttributeVersicherte
Attribute "given_name"
 (Claim)Vorname
 (given_name)
Attribute "family_name"
 (Claim)Nachname
 (family_name)
Attribute "organizationName"
 (Claim)Herausgeber-ID
 (organization_number)
Attribute "professionOID"
1.2.276.0.76.4.49
Identifier "idNummer"
 (Claim)unveränderlicher Teil der KV-Nummer
 (idNummer)
Attribut "amr""mfa"
Attribut "acr""gematik-ehealth-loa-high"]]></description>
    <description_html><![CDATA[Der Token-Endpunkt MUSS benötigte Attribute in Claims für das auszustellende <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;ACCESS_TOKEN&quot;</span> und das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;ID_TOKEN&quot;</span> ausschließlich aus den entsprechenden Claims des ID-Token des sektoralen Identity Provider beziehen.<br/>Der Claim &quot;amr&quot; MUSS entsprechend des ursprünglich zur Authentisierung verwendeten Authentisierungsmittels belegt werden.<br/> <br/> <p class="polarion-rte-caption-paragraph" data-keep-next="true">Tabelle <span class="polarion-rte-caption" data-sequence="Tabelle">#</span>: TAB_IDP_DIENST_000X Befüllung der Attribute nach Bestätigung durch einen sektoralen Identity Provider</p><table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%"><tbody><tr><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 350.462px;height: 38.175px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute</th><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 380.538px;height: 38.175px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherte</th></tr><tr><td style="text-align: left;vertical-align: top;width: 350.462px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">given_name</span>&quot;<br/> (Claim)</td><td style="text-align: left;vertical-align: top;width: 380.538px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Vorname<br/> (given_name)</td></tr><tr><td style="text-align: left;vertical-align: top;width: 350.462px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">family_name</span>&quot;<br/> (Claim)</td><td style="text-align: left;vertical-align: top;width: 380.538px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Nachname<br/> (family_name)</td></tr><tr><td style="text-align: left;vertical-align: top;width: 350.462px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">organizationName</span>&quot;<br/> (Claim)</td><td style="text-align: left;vertical-align: top;width: 380.538px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Herausgeber-ID<br/> (organization_number)</td></tr><tr><td style="text-align: left;vertical-align: top;width: 350.462px;height: 41.8125px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>&quot;<br/></td><td style="text-align: left;vertical-align: top;width: 380.538px;height: 41.8125px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.2.276.0.76.4.49</td></tr><tr><td style="text-align: left;vertical-align: top;width: 350.462px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Identifier &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span>&quot;<br/> (Claim)</td><td style="text-align: left;vertical-align: top;width: 380.538px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">unveränderlicher Teil der KV-Nummer<br/> (idNummer)</td></tr><tr><td style="text-align: left;vertical-align: top;width: 350.462px;height: 42.725px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribut &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">amr</span>&quot;</td><td style="text-align: left;vertical-align: top;width: 380.538px;height: 42.725px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&quot;mfa&quot;</td></tr><tr><td style="text-align: left;vertical-align: top;width: 350.462px;height: 42.725px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribut &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">acr</span>&quot;</td><td style="text-align: left;vertical-align: top;width: 380.538px;height: 42.725px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&quot;gematik-ehealth-loa-high&quot;</td></tr></tbody></table>]]></description_html>
  </requirement>
  <requirement id="A_20952" type="leafRequirement" severity="MUSS" lastUpdate="2021-04-09" technicalID="ML-113115" revision="426785">
    <title><![CDATA[Claim "aud" im Token setzen]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS den Claim "aud" im "ACCESS_TOKEN" entsprechend des 
angefragten Scopes des Authenticator-Moduls mit der URL des Fachdienstes füllen.]]></description>
    <description_html><![CDATA[Der<span id="polarion-comment:1458"></span> IdP-Dienst MUSS den Claim &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">aud</span>&quot; im &quot;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>&quot; entsprechend des angefragten Scopes des Authenticator-Moduls mit der URL des Fachdienstes füllen.]]></description_html>
  </requirement>
  <requirement id="A_22326" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-125074" revision="426785">
    <title><![CDATA[IDP-Dienst: Setzen des korrekten Issuer Claims]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS je nach Ursprung (aus der TI oder aus dem Internet) des 
Aufrufs des Authentication Request den Issuer Claim "iss" in seinen 
ausgestellten Token analog zum Issuer Claim "issuer" des jeweiligen Discovery 
Document - intern (TI) oder extern (Internet) - setzen.]]></description>
    <description_html><![CDATA[Der IDP-Dienst MUSS je nach Ursprung (aus der TI oder aus dem Internet) des Aufrufs des Authentication Request den Issuer Claim &quot;iss&quot; in seinen ausgestellten Token analog zum Issuer Claim &quot;issuer&quot; des jeweiligen Discovery Document - intern (TI) oder extern (Internet) - setzen. <span id="polarion-comment:1610"></span>]]></description_html>
  </requirement>
  <requirement id="A_20327-02" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-116339" revision="426785">
    <title><![CDATA[Signatur des "ID_TOKEN" und "ACCESS_TOKEN"]]></title>
    <description><![CDATA[Der Token-Endpunkt MUSS alle erstellten "ID_TOKEN" und "ACCESS_TOKEN", um deren 
Integrität sicherzustellen und eine eineindeutige Erklärung über deren Herkunft 
abzugeben, mit seinem privaten Schlüssel "PrK_IDP_SIG" signieren. [RFC7523 # 
section-3 <https://tools.ietf.org/html/rfc7523#section-3>  Spiegelpunkt 9] ist 
zu gewährleisten. Als Algorithmus ist dementsprechend "BP256R1" zu wählen.]]></description>
    <description_html><![CDATA[Der Token-Endpunkt MUSS alle erstellten &quot;ID_TOKEN&quot; und &quot;ACCESS_TOKEN&quot;, um deren Integrität sicherzustellen und eine eineindeutige Erklärung über deren Herkunft abzugeben, mit seinem privaten Schlüssel &quot;PrK_IDP_SIG&quot; signieren. [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7523#section-3">RFC7523 # section-3</a>  Spiegelpunkt 9] ist zu gewährleisten. Als Algorithmus ist dementsprechend &quot;BP256R1&quot; zu wählen.]]></description_html>
  </requirement>
  <requirement id="A_21321" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116340" revision="426785">
    <title><![CDATA[Verschlüsselung von "ACCESS_TOKEN" und "ID_TOKEN"]]></title>
    <description><![CDATA[Der Token-Endpunkt MUSS "ACCESS_TOKEN" und "ID_TOKEN" nach der Signatur mittels 
JWE [RFC7516 <https://tools.ietf.org/html/rfc7516>]) unter Nutzung des 
"Token-Key" des Anwendungsfrontend verschlüsseln.]]></description>
    <description_html><![CDATA[Der Token-Endpunkt MUSS &quot;ACCESS_TOKEN&quot; und &quot;ID_TOKEN&quot; nach der Signatur mittels JWE [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7516">RFC7516</a>]) unter Nutzung des &quot;Token-Key&quot; des Anwendungsfrontend verschlüsseln.]]></description_html>
  </requirement>
  <requirement id="A_20329-01" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-114463" revision="426785">
    <title><![CDATA[Sichere Übertragung von "ID_TOKEN" und "ACCESS_TOKEN"]]></title>
    <description><![CDATA[Der Token-Endpunkt MUSS "ID_TOKEN" und "ACCESS_TOKEN" beim Transport mit 
Transport Layer Security (TLS) gemäß [gemSpec_Krypt] schützen. ]]></description>
    <description_html><![CDATA[Der Token-Endpunkt <span style="font-weight: normal;">MUSS</span> <span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;</span><span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">ID_TOKEN</span><span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">&quot;</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&quot;ACCESS_TOKEN&quot;</span> beim Transport mit Transport Layer Security (TLS) gemäß [gemSpec_Krypt] schützen. <br/>]]></description_html>
  </requirement>
  <requirement id="A_21404" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116888" revision="426785">
    <title><![CDATA[Bewertung von Typen mobiler Endgeräte durch den IdP-Dienst]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS zu vorgelegten Informationen über einen Gerätetyp innerhalb 
der Registrierung oder der Authentifizierung die folgende Einstufung vornehmen 
können:
 Ein Gerätetyp ist zur Verwendung als Faktor innerhalb eines alternativen 
Authentisierungsmittels entweder

 * ohne Einschränkung geeignet oder
 * mit Einschränkung geeignet oder
 * nicht geeignet.Ein Gerätetyp wird durch die folgenden Informationen 
beschrieben: Hersteller, Produkt, Modell, Betriebssystem, Version des 
Betriebssystems. Die Zuordnung wird in den folgenden Anforderungen als 
"Block/Allow"-Liste beschrieben. Gerätetypen, die ohne Einschränkung geeignet 
sind, befinden sich auf der "Allow"-Liste; Gerätetypen, die nicht geeignet 
sind, befinden sich auf der "Block"-Liste.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS zu vorgelegten Informationen über einen Gerätetyp innerhalb der Registrierung oder der Authentifizierung die folgende Einstufung vornehmen können: <br/> Ein Gerätetyp ist zur Verwendung als Faktor innerhalb eines alternativen Authentisierungsmittels entweder<br/> <ul><li>ohne Einschränkung geeignet oder</li><li>mit Einschränkung geeignet oder</li><li>nicht geeignet.</li></ul>Ein Gerätetyp wird durch die folgenden Informationen beschrieben: Hersteller, Produkt, Modell, Betriebssystem, Version des Betriebssystems. Die Zuordnung wird in den folgenden Anforderungen als &quot;Block/Allow&quot;-Liste beschrieben. Gerätetypen, die ohne Einschränkung geeignet sind, befinden sich auf der &quot;Allow&quot;-Liste; Gerätetypen, die nicht geeignet sind, befinden sich auf der &quot;Block&quot;-Liste.]]></description_html>
  </requirement>
  <requirement id="A_21405" type="leafRequirement" severity="MUSS" lastUpdate="2021-09-30" technicalID="ML-116889" revision="426785">
    <title><![CDATA[Management der Gerätetypen und ihrer Einstufung]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS dem CERT der gematik das Management der 
Datenbasis der Gerätetypen und die Zuordnung in eine der oben genannten 
Kategorien gestatten:

 * Das CERT der gematik MUSS für die Anpassung der Block/Allow-Liste des 
IdP-Dienstes einen Service Request im TI-ITSM-System stellen.

 * Der IdP-Dienst muss für die Anpassung der Block/Allow-Liste des 
IdP-Dienstes einen Service im TI-ITSM bereitstellen und die Datenbasis 
entsprechend aktualisieren.
Die Daten enthalten in expliziter Form ausschließlich Gerätetypen, die 
 * ohne Einschränkung geeignet sind.

 * nicht geeignet sind.
Gerätetypen, die keine ausdrückliche Nennung erfahren, sind vom IdP-Dienst in 
den Protokollabläufen als bedingt geeignet einzustufen.]]></description>
    <description_html><![CDATA[Der Anbieter des IdP-Dienstes MUSS dem CERT der gematik das Management der Datenbasis der Gerätetypen und die Zuordnung in eine der oben genannten Kategorien gestatten: <br/> <ul><li><span style="color: #000000;">Das CERT der gematik MUSS für die Anpassung der Block/Allow-Liste des IdP-Dienstes einen Service Request im TI-ITSM-System stellen.</span><br/></li><li><span style="color: #000000;">Der IdP-Dienst muss für die Anpassung der Block/Allow-Liste des IdP-Dienstes einen Service im TI-ITSM bereitstellen und die Datenbasis entsprechend aktualisieren.</span><br/></li></ul><span style="color: #000000;">Die Daten enthalten in expliziter Form ausschließlich Gerätetypen, die</span> <div style="margin-left: 40px;"></div><ul><li>ohne Einschränkung geeignet sind.<br/></li><li>nicht geeignet sind.<br/></li></ul><div style="margin-left: 40px;"></div> <span style="color: #000000;">Gerätetypen, die keine ausdrückliche Nennung erfahren, sind vom IdP-Dienst in den Protokollabläufen als bedingt geeignet einzustufen.</span>]]></description_html>
  </requirement>
  <requirement id="A_21406" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116890" revision="426785">
    <title><![CDATA[Anforderungen an Transaktionalität der Freischaltung der Einstufung von Gerätetypen]]></title>
    <description><![CDATA[Innerhalb eines Service-Requests vom CERT der gematik wird der vollständige, ab 
Freischaltung zur Einstufung zu verwendende Datenbestand der Block/Allow-Liste 
übermittelt. Der IdP-Dienst MUSS genau diese Daten innerhalb eines festgelegten 
Zeitraums zum Zweck der Einstufung wirksam werden lassen. Die alte Datenbasis 
wird hierbei vollständig ersetzt.]]></description>
    <description_html><![CDATA[Innerhalb eines Service-Requests vom CERT der gematik wird der vollständige, ab Freischaltung zur Einstufung zu verwendende Datenbestand der Block/Allow-Liste übermittelt. Der IdP-Dienst MUSS genau diese Daten innerhalb eines festgelegten Zeitraums zum Zweck der Einstufung wirksam werden lassen. Die alte Datenbasis wird hierbei vollständig ersetzt.]]></description_html>
  </requirement>
  <requirement id="A_21407" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116891" revision="426785">
    <title><![CDATA[Vorhalten von Backup-Daten zur Einstufung von Gerätetypen]]></title>
    <description><![CDATA[Der IdP-Dienst MUSS die Transaktionen der Datenbasis zur Einstufung der 
Gerätetypen (Block/Allow-Liste) der letzten 6 Monate speichern und in der Lage 
sein, bei Bedarf auf eine vorherige Version des Bestandes zurückfallen zu 
können.]]></description>
    <description_html><![CDATA[Der IdP-Dienst MUSS die Transaktionen der Datenbasis zur Einstufung der Gerätetypen (Block/Allow-Liste) der letzten 6 Monate speichern und in der Lage sein, bei Bedarf auf eine vorherige Version des Bestandes zurückfallen zu können.]]></description_html>
  </requirement>
  <requirement id="A_21408" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116892" revision="426785">
    <title><![CDATA[Exportierbarkeit der Datenbasis zur Einstufung von Gerätetypen]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS die aktuell verwendete Datenbasis zur 
Einstufung der Gerätetypen (Block/Allow-Liste) oder die innerhalb der letzten 6 
Monate verwendete Version der Datenbasis der gematik zur Verfügung stellen.  ]]></description>
    <description_html><![CDATA[Der Anbieter des IdP-Dienstes MUSS die aktuell verwendete Datenbasis zur Einstufung der Gerätetypen (Block/Allow-Liste) oder die innerhalb der letzten 6 Monate verwendete Version der Datenbasis der gematik zur Verfügung stellen.  <br/>]]></description_html>
  </requirement>
  <requirement id="A_21409" type="leafRequirement" severity="MUSS" lastUpdate="2021-09-30" technicalID="ML-116893" revision="426785">
    <title><![CDATA[Anforderung an die Revisionssicherheit des Managements der Datenbasis zur Einstufung von Gerätetypen]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS die erfolgten Änderungen an der Datenbasis 
der Block/Allow-Liste revisionssicher protokollieren. Das System MUSS jederzeit 
Auskunft darüber geben können,

 * was geschehen ist (z. B. Import oder Export der Datenbasis).
 * wer den Import oder Export ausgelöst hat (Basis ist die Protokollierung von 
Authentifizierungsinformationen).
 * wann dies geschehen ist (Basis sind Zeitstempel der Protokollierung).
 * wie dies geschehen ist (auf welche Weise die Datenbasis übertragen wurden, 
Quell-IP-Adressen, Systemprotokolle, Art und Weise der Authentisierung am 
System).]]></description>
    <description_html><![CDATA[Der Anbieter des IdP-Dienstes MUSS die erfolgten Änderungen an der Datenbasis der Block/Allow-Liste revisionssicher protokollieren. Das System MUSS jederzeit Auskunft darüber geben können,<br/> <ul><li>was geschehen ist (z. B. Import oder Export der Datenbasis).</li><li>wer den Import oder Export ausgelöst hat (Basis ist die Protokollierung von Authentifizierungsinformationen).</li><li>wann dies geschehen ist (Basis sind Zeitstempel der Protokollierung).</li><li>wie dies geschehen ist (auf welche Weise die Datenbasis übertragen wurden, Quell-IP-Adressen, Systemprotokolle, Art und Weise der Authentisierung am System).</li></ul>]]></description_html>
  </requirement>
  <requirement id="A_21410" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116894" revision="426785">
    <title><![CDATA[Registrierung des Pairing-Endpunkts und des Authenticator-Moduls am IdP-Dienst]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS beim IdP-Dienst im Sinne von Abschnitt 4 aus 
[gemSpec_IDP_FD] registriert sein. Der registrierte Scope MUSS „openid pairing“ 
sein. Der beantragte Claim MUSS der folgende sein:

 * idNummer.Weitere Body-Claims DÜRFEN NICHT angefordert werden. Bestehende 
Header-Claims, die zur Prüfung der Gültigkeit von ACCESS_TOKEN verwendet 
werden, sind hiervon unberührt. Andere Fachdienste DÜRFEN mit dem genannten 
Scope NICHT registrierbar sein.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS beim IdP-Dienst im Sinne von Abschnitt 4 aus [gemSpec_IDP_FD] registriert sein. Der registrierte Scope MUSS „openid pairing“ sein. Der beantragte Claim MUSS der folgende sein:<br/><ul><li>idNummer.</li></ul>Weitere Body-Claims DÜRFEN NICHT angefordert werden. Bestehende Header-Claims, die zur Prüfung der Gültigkeit von ACCESS_TOKEN verwendet werden, sind hiervon unberührt. Andere Fachdienste DÜRFEN mit dem genannten Scope NICHT registrierbar sein.]]></description_html>
  </requirement>
  <requirement id="A_21429-02" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-118135" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Realisierung verschiedener Authentifizierungsmethoden]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS über eine dedizierte URL bereitgestellt werden. Die 
URL MUSS im externen Discovery Document aufgenommen und über das Attribut 
"uri_pair" im externen Discovery Document hinterlegt werden.
Im externen Discovery Document MUSS ebenfalls die Adresse des Endpunkts für 
die alternative Authentisierung (mit einem registrierten Pairing) über das 
Attribut "auth_pair_endpoint" hinterlegt werden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS über eine dedizierte URL bereitgestellt werden. Die URL MUSS im externen Discovery Document aufgenommen und über das Attribut &quot;uri_pair&quot; im externen Discovery Document hinterlegt werden.<br/>Im externen Discovery Document MUSS ebenfalls die Adresse des Endpunkts für die alternative Authentisierung (mit einem registrierten Pairing) über das Attribut &quot;auth_pair_endpoint&quot; hinterlegt werden.]]></description_html>
  </requirement>
  <requirement id="A_21415" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116899" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Datenformate und Syntax zur Kommunikation mit dem Authenticator-Modul]]></title>
    <description><![CDATA[Die Registrierungsfunktion des IdP-Dienstes MUSS die folgenden Datentypen zur 
Kommunikation mit dem Authenticator-Modul verwenden: 

 * Device_Type
 * Device_Information
 * Pairing_Data
 * Signed_Pairing_Data
 * Registration_Data
 * Encrypted_Registration_Data.]]></description>
    <description_html><![CDATA[Die Registrierungsfunktion des IdP-Dienstes MUSS die folgenden Datentypen zur Kommunikation mit dem Authenticator-Modul verwenden: <br/> <ul><li>Device_Type</li><li>Device_Information</li><li>Pairing_Data</li><li>Signed_Pairing_Data</li><li>Registration_Data</li><li>Encrypted_Registration_Data.</li></ul>]]></description_html>
  </requirement>
  <requirement id="A_21411" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116895" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Fehlermeldungen]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS im Zusammenhang mit der Registrierungsfunktion die 
folgenden Fehlermeldungen produzieren:


Tabelle #: Fehlermeldungen im Zusammenhang mit der Registrierungsfunktion

NummerFehlermeldungstext
REG.1Der Zugriff auf den Dienst kann nicht gewährt werden.
REG.2Das verwendete Gerät ist nicht für die Authentisierung geeignet.
REG.3Der erzeugte Schlüssel konnte aufgrund eines internen Fehlers nicht 
registriert werden.
REG.4Der erzeugte Schlüssel konnte aufgrund eines bestehenden Eintrags nicht 
registriert werden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS im Zusammenhang mit der Registrierungsfunktion die folgenden Fehlermeldungen produzieren:<br/> <br/> <p style="text-align: left;" class="polarion-rte-caption-paragraph">Tabelle <span class="polarion-rte-caption" data-sequence="Tabelle">#</span>: Fehlermeldungen im Zusammenhang mit der Registrierungsfunktion</p><table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%"><tbody><tr><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 94px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Nummer</th><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 853.2px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Fehlermeldungstext</th></tr><tr><td style="text-align: left;vertical-align: top;width: 94px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">REG.1</td><td style="text-align: left;vertical-align: top;width: 853.2px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Der Zugriff auf den Dienst kann nicht gewährt werden.</td></tr><tr><td style="text-align: left;vertical-align: top;width: 94px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">REG.2</td><td style="text-align: left;vertical-align: top;width: 853.2px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Das verwendete Gerät ist nicht für die Authentisierung geeignet.</td></tr><tr><td style="text-align: left;vertical-align: top;width: 94px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">REG.3</td><td style="text-align: left;vertical-align: top;width: 853.2px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Der erzeugte Schlüssel konnte aufgrund eines internen Fehlers nicht registriert werden.</td></tr><tr><td style="text-align: left;vertical-align: top;width: 94px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">REG.4</td><td style="text-align: left;vertical-align: top;width: 853.2px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Der erzeugte Schlüssel konnte aufgrund eines bestehenden Eintrags nicht registriert werden.</td></tr></tbody></table><br/>]]></description_html>
  </requirement>
  <requirement id="A_21412" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116896" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Registrierung]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS zulassen, dass mehrere Geräte pro Nutzer registriert 
werden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS zulassen, dass mehrere Geräte pro Nutzer registriert werden.]]></description_html>
  </requirement>
  <requirement id="A_21413" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116897" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Prüfung des Scope]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS die Nutzung der Registrierungsfunktion ausschließlich 
auf Basis eines vom IdP-Dienst für das Authenticator-Modul erstellten 
ACCESS_TOKEN mit dem Scope "openid pairing" ermöglichen.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS die Nutzung der Registrierungsfunktion ausschließlich auf Basis eines vom IdP-Dienst für das Authenticator-Modul erstellten ACCESS_TOKEN mit dem Scope &quot;openid pairing&quot; ermöglichen.]]></description_html>
  </requirement>
  <requirement id="A_21425" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116909" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Validierung des übermittelten ACCESS_TOKENS]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS die verschlüsselten Registrierungsdaten und den 
übermittelten ACCESS_TOKEN annehmen. Die Prüfung des ACCESS_TOKEN erfolgt wie 
in [gemSpec_IDP_FD], Abschnitt 6 beschrieben. Der Pairing-Endpunkt MUSS das 
bezogene ACCESS_TOKEN mit dem PrK.IDP.ENC entschlüsseln. Das zur 
Entschlüsselung des ACCESS_TOKEN zu verwendende Verfahren ist ECDH-ES.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS die verschlüsselten Registrierungsdaten und den übermittelten ACCESS_TOKEN annehmen. Die Prüfung des ACCESS_TOKEN erfolgt wie in [gemSpec_IDP_FD], Abschnitt 6 beschrieben. Der Pairing-Endpunkt MUSS das bezogene ACCESS_TOKEN mit dem PrK.IDP.ENC entschlüsseln. Das zur Entschlüsselung des ACCESS_TOKEN zu verwendende Verfahren ist ECDH-ES<span style="font-size: 11pt;font-family: Arial, Helvetica;color: #172B4D;line-height: 1.5;">.</span>]]></description_html>
  </requirement>
  <requirement id="A_21419" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116903" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Anforderung an die Authentifizierung des Nutzers]]></title>
    <description><![CDATA[Der Pairing-Endpunkt des IdP-Dienstes MUSS sicherstellen, dass die 
Registrierung ausschließlich auf Basis von ACCESS_TOKEN durchgeführt wird, die 
belegen, dass sich der Nutzer auf Basis der eGK authentifiziert hat. Dieser 
Beleg MUSS aus den Werten für die Claims „amr“ und „acr“ abgeleitet werden. 
Diese MÜSSEN wie folgt belegt sein: acr=“gematik-ehealth-loa-high“, 
amr=“["mfa“,“sc“,“pin“].]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt des IdP-Dienstes MUSS sicherstellen, dass die Registrierung ausschließlich auf Basis von ACCESS_TOKEN durchgeführt wird, die belegen, dass sich der Nutzer auf Basis der eGK authentifiziert hat. Dieser Beleg MUSS aus den Werten für die Claims „amr“ und „acr“ abgeleitet werden. Diese MÜSSEN wie folgt belegt sein: acr=“gematik-ehealth-loa-high“, amr=“[&quot;mfa“,“sc“,“pin“].]]></description_html>
  </requirement>
  <requirement id="A_21420" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116904" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Entschlüsselung der Registrierungsdaten]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS die übermittelten Registrierungsdaten mit dem 
PrK.IDP.ENC entschlüsseln. ]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS die übermittelten Registrierungsdaten mit dem PrK.IDP.ENC entschlüsseln. <br/>]]></description_html>
  </requirement>
  <requirement id="A_21421" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116905" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Validierung der signierten Pairing-Daten]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS die in den übermittelten Registrierungsdaten 
enthaltenen Pairing-Daten extrahieren und MUSS die Signatur des Nutzers zu den 
Pairing-Daten prüfen. Die Prüfung des Authentifizierungszertifikats MUSS 
hierbei auf Basis der aktuellen Systemzeit des Pairing-Endpunkts als 
Referenzzeit und gemäß [gemSpec_PKI], Abschnitt 8.3.1.1 „TUC_PKI_018“ erfolgen.
Der IdP-Dienst MUSS zur Validierung alle Algorithmen unterstützen, die im 
Zusammenhang mit den Authentisierungsmitteln verwendet werden, die zur 
Authentisierung am IdP-Dienst zugelassen sind (siehe [gemSpec_IDP_Frontend], 
Abschnitt 3). Hierbei MÜSSEN die Vorgaben aus Abschnitt 9.3.4 
[gemSpec_IDP_Frontend] beachtet werden. Andere Algorithmen DÜRFEN NICHT 
unterstützt werden. Kann die Authentizität der Pairing-Daten nicht belegt 
werden oder ist das übermittelte Authentifizierungszertifikat zum aktuellen 
Zeitpunkt ungültig oder gesperrt, MUSS der Pairing-Endpunkt die Anfrage mit der 
Fehlermeldung REG.1 beenden. Unter "Authentifizierungszertifikat" wird ein 
Zertifikat des Typs C.CH.AUT verstanden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS die in den übermittelten Registrierungsdaten enthaltenen Pairing-Daten extrahieren und MUSS die Signatur des Nutzers zu den Pairing-Daten prüfen. Die Prüfung des Authentifizierungszertifikats MUSS hierbei auf Basis der aktuellen Systemzeit des Pairing-Endpunkts als Referenzzeit und gemäß [gemSpec_PKI], Abschnitt 8.3.1.1 „TUC_PKI_018“ erfolgen. <span style="font-size: 10pt;line-height: 1.5;">Der IdP-Dienst MUSS zur Validierung alle Algorithmen unterstützen, die im Zusammenhang mit den Authentisierungsmitteln verwendet werden, die zur Authentisierung am IdP-Dienst zugelassen sind (siehe [gemSpec_IDP_Frontend], Abschnitt 3). Hierbei MÜSSEN die Vorgaben aus Abschnitt 9.3.4 [gemSpec_IDP_Frontend] beachtet werden. Andere Algorithmen DÜRFEN NICHT unterstützt werden.</span> Kann die Authentizität der Pairing-Daten nicht belegt werden oder ist das übermittelte Authentifizierungszertifikat zum aktuellen Zeitpunkt ungültig oder gesperrt, MUSS der Pairing-Endpunkt die Anfrage mit der Fehlermeldung REG.1 beenden. <span style="font-size: 10pt;line-height: 1.5;">Unter &quot;Authentifizierungszertifikat&quot; wird ein Zertifikat des Typs C.CH.AUT verstanden.</span>]]></description_html>
  </requirement>
  <requirement id="A_21422" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116906" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Validierung des Zusammenhangs von ACCESS_TOKEN und Pairing-Daten]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS überprüfen, ob sich das übermittelte ACCESS_TOKEN und 
sich die im Authentifizierungszertifikat eingebetteten Identitätsinformationen 
auf ein und dieselbe Entität zurückführen lassen: Der Pairing-Endpunkt MUSS 
dafür prüfen, ob der im ACCESS_TOKEN eingebettete Claim „idNummer“ identisch 
mit der im Authentifizierungszertifikat vorhandenen „idNummer“ ist. Sind diese 
nicht identisch, MUSS der Pairing-Endpunkt die Anfrage mit der Fehlermeldung 
REG.1 beenden. Unter Authentifizierungszertifikat wird hierbei ein Zertifikat 
vom Typ C.CH.AUT verstanden. ]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS überprüfen, ob sich das übermittelte ACCESS_TOKEN und sich die im Authentifizierungszertifikat eingebetteten Identitätsinformationen auf ein und dieselbe Entität zurückführen lassen: Der Pairing-Endpunkt MUSS dafür prüfen, ob der im ACCESS_TOKEN eingebettete Claim „idNummer“ identisch mit der im Authentifizierungszertifikat vorhandenen „idNummer“ ist. Sind diese nicht identisch, MUSS der Pairing-Endpunkt die Anfrage mit der Fehlermeldung REG.1 beenden. Unter Authentifizierungszertifikat wird hierbei ein Zertifikat vom Typ C.CH.AUT verstanden. ]]></description_html>
  </requirement>
  <requirement id="A_21470" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-117312" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Prüfung des Zusammenhangs zwischen Pairing-Daten und übermittelten Authentifizierungszertifikat]]></title>
    <description><![CDATA[Der Pairing-Endpunkt des IdP-Dienstes MUSS überprüfen, ob sich die in den 
Pairing-Daten befindlichen Daten „issuer“, „serialnumber“, 
„auth_cert_subject_public_key_info“, „not_after“ identisch zu den 
Zertifikatsfeldern „issuer“, „serialNumber“, „subjectPublicKeyInfo“, „notAfter“ 
des übermittelten Authentifizierungszertifikats sind. Schlägt einer dieser 
Vergleiche fehl, MUSS der Pairing-Endpunkt die Anfrage mit der Fehlermeldung 
REG.1 beenden. Unter "Authentifizierungszertifikat" wird ein Zertifikat des 
Typs C.CH.AUT verstanden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt des IdP-Dienstes MUSS überprüfen, ob sich die in den Pairing-Daten befindlichen Daten „issuer“, „serialnumber“, „auth_cert_subject_public_key_info“, „not_after“ identisch zu den Zertifikatsfeldern „issuer“, „serialNumber“, „subjectPublicKeyInfo“, „notAfter“ des übermittelten Authentifizierungszertifikats sind. Schlägt einer dieser Vergleiche fehl, MUSS der Pairing-Endpunkt die Anfrage mit der Fehlermeldung REG.1 beenden. Unter &quot;Authentifizierungszertifikat&quot; wird ein Zertifikat des Typs C.CH.AUT verstanden.]]></description_html>
  </requirement>
  <requirement id="A_21423" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116907" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Bewertung des Gerätetyps]]></title>
    <description><![CDATA[Der Pairing-Endpunkt des IdP-Dienstes MUSS die vom Authenticator-Modul 
übertragenen Geräteinformationen gegen die Block/Allow-Liste prüfen. Bei 
Zuordenbarkeit der Geräteinformationen zu einem Gerätetyp auf der Block-Liste 
MUSS der Pairing-Endpunkt den Registrierungsvorgang mit der Fehlermeldung REG.2 
beenden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt des IdP-Dienstes MUSS die vom Authenticator-Modul übertragenen Geräteinformationen gegen die Block/Allow-Liste prüfen. Bei Zuordenbarkeit der Geräteinformationen zu einem Gerätetyp auf der Block-Liste MUSS der Pairing-Endpunkt den Registrierungsvorgang mit der Fehlermeldung REG.2 beenden.]]></description_html>
  </requirement>
  <requirement id="A_21424" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116908" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Speicherung der Pairing-Daten]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS die folgenden Daten und den Zeitpunkt der Speicherung 
in seiner Pairing-Datenbank speichern:

 * den Namen des Geräts (aus den in den Registrierungsdaten übertragenen 
Geräteinformationen im Datentyp "Device_Information")
 * die signierten Pairing-Daten
 * den aktuellen Zeitpunkt.  Die logische Kombination dieser Daten MUSS über 
die idNummer referenzierbar sein und sie MUSS über die Kombination aus 
(idNummer, keyIdentifier) eindeutig referenzierbar sein. Unter „keyIdentifier“ 
wird hierbei das Feld „key_Identifier“ aus den Pairing-Daten verstanden. 
Eventuelle Kollisionen mit bestehenden Pairing-Daten MÜSSEN mit der 
Fehlermeldung REG.4 begegnet werden. Der Pairing-Endpunkt DARF die 
übermittelten Daten in diesem Fall NICHT speichern.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS die folgenden Daten und den Zeitpunkt der Speicherung in seiner Pairing-Datenbank speichern:<br/> <ul><li>den Namen des Geräts (aus den in den Registrierungsdaten übertragenen Geräteinformationen im Datentyp &quot;Device_Information&quot;)</li><li>die signierten Pairing-Daten</li><li>den aktuellen Zeitpunkt.  </li></ul>Die logische Kombination dieser Daten MUSS über die idNummer referenzierbar sein und sie MUSS über die Kombination aus (idNummer, keyIdentifier) eindeutig referenzierbar sein. Unter „keyIdentifier“ wird hierbei das Feld „key_Identifier“ aus den Pairing-Daten verstanden. Eventuelle Kollisionen mit bestehenden Pairing-Daten MÜSSEN mit der Fehlermeldung REG.4 begegnet werden. Der Pairing-Endpunkt DARF die übermittelten Daten in diesem Fall NICHT speichern.]]></description_html>
  </requirement>
  <requirement id="A_21426" type="leafRequirement" severity="DARF NICHT" lastUpdate="2021-06-15" technicalID="ML-116910" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Nicht-Speicherung des übermittelten Authentifizierungszertifikats]]></title>
    <description><![CDATA[Der Pairing-Endpunkt DARF das im Zuge der Registrierung in den 
Registrierungsdaten übertragene Authentifizierungszertifikat NICHT persistent 
speichern. Unter "Authentifizierungszertifikat" wird ein Zertifikat des Typs 
C.CH.AUT verstanden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt DARF das im Zuge der Registrierung in den Registrierungsdaten übertragene Authentifizierungszertifikat NICHT persistent speichern. <span style="font-size: 10pt;line-height: 1.5;">Unter &quot;Authentifizierungszertifikat&quot; wird ein Zertifikat des Typs C.CH.AUT verstanden.</span>]]></description_html>
  </requirement>
  <requirement id="A_21427" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116911" revision="426785">
    <title><![CDATA[Registrierungsfunktion des IdP-Dienstes: Rückmeldung an den Nutzer]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS dem Authenticator-Modul eine eindeutige Rückmeldung 
über den Erfolg oder Misserfolg der Anlage des Pairings übermitteln.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS dem Authenticator-Modul eine eindeutige Rückmeldung über den Erfolg oder Misserfolg der Anlage des Pairings übermitteln.]]></description_html>
  </requirement>
  <requirement id="A_21449" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116933" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Datenmodell und Syntax zur Kommunikation mit dem Authenticator-Modul]]></title>
    <description><![CDATA[Der Authorization-Endpunkt des IdP-Dienstes MUSS bei der Verwendung von 
alternativen Authentisierungsmitteln die folgenden Datentypen zur Kommunikation 
mit dem Authenticator-Modul verwenden:

 * Authentication_Data
 * Signed_Authentication_Data
 * Encrypted_Signed_Authentication_Data.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt des IdP-Dienstes MUSS bei der Verwendung von alternativen Authentisierungsmitteln die folgenden Datentypen zur Kommunikation mit dem Authenticator-Modul verwenden:<br/> <ul><li><span style="font-size: 10pt;line-height: 1.5;">Authentication_Data</span></li><li><span style="font-size: 10pt;line-height: 1.5;">Signed_Authentication_Data</span></li><li><span style="font-size: 10pt;line-height: 1.5;">Encrypted_Signed_Authentication_Data.</span></li></ul>]]></description_html>
  </requirement>
  <requirement id="A_21428" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116912" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Fehlermeldungen]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS bei Authentifizierung von Nutzern auf Basis von 
alternativen Authentisierungsmitteln die folgenden Fehlermeldungen produzieren:


Tabelle #: Fehlermeldungen des Authorization-Endpunkts bei Authentifizierung 
auf Basis von alternativen Authentisierungsmitteln

NummerFehlermeldungstext
VAL.1Die Authentifizierung mit einem alternativen 
Authentifizierungsmittel konnte nicht erfolgreich durchgeführt werden.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS bei Authentifizierung von Nutzern auf Basis von alternativen Authentisierungsmitteln die folgenden Fehlermeldungen produzieren:<br/> <br/> <p style="text-align: left;" class="polarion-rte-caption-paragraph">Tabelle <span class="polarion-rte-caption" data-sequence="Tabelle">#</span>: Fehlermeldungen des Authorization-Endpunkts bei Authentifizierung auf Basis von alternativen Authentisierungsmitteln</p><table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%"><tbody><tr><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 66.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Nummer</th><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 790px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Fehlermeldungstext</th></tr><tr><td style="text-align: left;vertical-align: top;width: 66.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">VAL.1</td><td style="text-align: left;vertical-align: top;width: 790px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Die Authentifizierung mit einem alternativen Authentifizierungsmittel konnte nicht erfolgreich durchgeführt werden.</td></tr></tbody></table>]]></description_html>
  </requirement>
  <requirement id="A_21432" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116916" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Prüfung der vorliegenden Gerätedaten]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS die in der 
Authentication_Data/Device_Information-Struktur dargelegten Informationen zum 
Gerätetyp auf Basis der Block/Allow-Liste bewerten. Sofern das Gerät als nicht 
geeignet im Sinne der Anforderung A_21404 eingestuft ist, MUSS der 
Authentifizierungsvorgang mit der Fehlermeldung „access_denied“ und der 
„error_description“ VAL.1 genannt abgebrochen werden. Die Zuordnung zwischen 
gelieferten Informationen zum Gerätetyp und der Datenbasis der 
Block/Allow-Liste MUSS auf Basis des Vergleichs der in den einzelnen Claims 
enthaltenen Strings erfolgen.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS die in der Authentication_Data/Device_Information-Struktur dargelegten Informationen zum Gerätetyp auf Basis der Block/Allow-Liste bewerten. Sofern das Gerät als nicht geeignet im Sinne der Anforderung A_21404 eingestuft ist, MUSS der Authentifizierungsvorgang mit der Fehlermeldung „access_denied“ und der „error_description“ VAL.1 genannt abgebrochen werden. Die Zuordnung zwischen gelieferten Informationen zum Gerätetyp und der Datenbasis der Block/Allow-Liste MUSS auf Basis des Vergleichs der in den einzelnen Claims enthaltenen Strings erfolgen.]]></description_html>
  </requirement>
  <requirement id="A_21433" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116917" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Validierung des Authentifizierungszertifikats]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS die Gültigkeit des in der 
Signed_Authentication_Data-Struktur gelieferten Authentifizierungszertifikats 
überprüfen. Die Zertifikatsprüfung des Authentifizierungszertifikats muss 
hierbei auf Basis der Systemzeit des Pairing-Endpunkts als Referenzzeit 
erfolgen. Die Prüfung des Zertifikats MUSS gemäß [gemSpec_PKI], Abschnitt 
8.3.1.1 „TUC_PKI_018“ erfolgen. Bei ungültigem oder gesperrtem Zertifikat MUSS 
der Authorization-Endpunkt die Verarbeitung abbrechen.Die Fehlermeldungen MUSS 
„access_denied“ mit „error_description“ VAL.1 sein. Unter 
"Authentifizierungszertifikat" wird ein Zertifikat des Typs C.CH.AUT verstanden.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS die Gültigkeit des in der Signed_Authentication_Data-Struktur gelieferten Authentifizierungszertifikats überprüfen. Die Zertifikatsprüfung des Authentifizierungszertifikats muss hierbei auf Basis der Systemzeit des Pairing-Endpunkts als Referenzzeit erfolgen. Die Prüfung des Zertifikats MUSS gemäß [gemSpec_PKI], Abschnitt 8.3.1.1 „TUC_PKI_018“ erfolgen. Bei ungültigem oder gesperrtem Zertifikat MUSS der Authorization-Endpunkt die Verarbeitung abbrechen. <span style="font-size: 10pt;line-height: 1.5;">Die</span> Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein. Unter &quot;Authentifizierungszertifikat&quot; wird ein Zertifikat des Typs C.CH.AUT verstanden.]]></description_html>
  </requirement>
  <requirement id="A_21434" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116918" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Auslesen der gespeicherten Pairing-Daten]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS die idNummer aus dem übermittelten 
Authentifizierungszertifikat entnehmen (vergleiche A_20524 [gemSpec_IDP_Dienst] 
und [gemSpec_PKI], Abschnitt 4.2 zur Erläuterung). Der Authorization-Endpunkt 
MUSS anhand des in den Signed_Authentication_Data übermittelten Key-Identifiers 
und der extrahierten idNummer die Pairing-Daten aus der Pairing-Datenbank 
beziehen. Falls kein solcher Datensatz existiert, MUSS der 
Authorization-Endpunkt den Prozess mit einer Fehlermeldung abbrechen. Die 
Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein. Unter 
"Authentifizierungszertifikat" wird ein Zertifikat des Typs C.CH.AUT verstanden.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS die idNummer aus dem übermittelten Authentifizierungszertifikat entnehmen (vergleiche A_20524 [gemSpec_IDP_Dienst] und [gemSpec_PKI], Abschnitt 4.2 zur Erläuterung). Der Authorization-Endpunkt MUSS anhand des in den Signed_Authentication_Data übermittelten Key-Identifiers und der extrahierten idNummer die Pairing-Daten aus der Pairing-Datenbank beziehen. Falls kein solcher Datensatz existiert, MUSS der Authorization-Endpunkt den Prozess mit einer Fehlermeldung abbrechen. Die Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein. <span style="font-size: 10pt;line-height: 1.5;">Unter &quot;Authentifizierungszertifikat&quot; wird ein Zertifikat des Typs C.CH.AUT verstanden.</span>]]></description_html>
  </requirement>
  <requirement id="A_21435" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116919" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Validierung der mathematischen Integrität der gespeicherten Pairing-Daten]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS die Integrität der hinterlegten Pairing-Daten 
mithilfe des öffentlichen Schlüssels des Authentifizierungszertifikats 
überprüfen. Erweisen sich die (mathematische) Integrität der Daten nicht als 
gewährleistet, MUSS die Verarbeitung mit einer Fehlermeldung abgebrochen 
werden. Die Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 
sein. Unter "Authentifizierungszertifikat" wird ein Zertifikat des Typs 
C.CH.AUT verstanden.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS die Integrität der hinterlegten Pairing-Daten mithilfe des öffentlichen Schlüssels des Authentifizierungszertifikats überprüfen. Erweisen sich die (mathematische) Integrität der Daten nicht als gewährleistet, MUSS die Verarbeitung mit einer Fehlermeldung abgebrochen werden. Die Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein. <span style="font-size: 10pt;line-height: 1.5;">Unter &quot;Authentifizierungszertifikat&quot; wird ein Zertifikat des Typs C.CH.AUT verstanden.</span><br/>]]></description_html>
  </requirement>
  <requirement id="A_21437" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116921" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Bewertung der Gültigkeit des öffentlichen Schlüssels in den Pairing-Daten]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS die Eignung des in den Pairing-Daten 
gespeicherten öffentlichen Schlüssels PuK_SE_AUT zur Prüfung der Integrität der 
Signed_Authentication_Data-Struktur wie folgt bewerten:

 * Falls der Typ des Geräts des Endnutzers eine Einstufung als uneingeschränkt 
geeignet im Sinne von A_21404 besitzt, ist der öffentliche Schlüssel für die 
Validierung der Signed_Authentication_Data-Struktur zu verwenden.
 * Falls andernfalls der Typ des Geräts des Endnutzers eine Einstufung als 
eingeschränkt geeignet im Sinne von A_21404 besitzt, ist der öffentliche 
Schlüssel für die Validierung der Signed_Authentication_Data-Struktur geeignet, 
wenn der Anlagezeitpunkt des Pairings nicht mehr als 6 Monate zurückliegt (d.h. 
sofern die aktuelle Zeit < pairing_entry.creationTime+6 Monate ist). Hierbei 
DARF auf den vollen Tag aufgerundet werden. Ist dies nicht der Fall, so MUSS 
die Verarbeitung mit einer Fehlermeldung abgebrochen werden. Die 
Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS die Eignung des in den Pairing-Daten gespeicherten öffentlichen Schlüssels PuK_SE_AUT zur Prüfung der Integrität der Signed_Authentication_Data-Struktur wie folgt bewerten: <br/> <ul><li>Falls der Typ des Geräts des Endnutzers eine Einstufung als uneingeschränkt geeignet im Sinne von A_21404 besitzt, ist der öffentliche Schlüssel für die Validierung der Signed_Authentication_Data-Struktur zu verwenden.</li><li>Falls andernfalls der Typ des Geräts des Endnutzers eine Einstufung als eingeschränkt geeignet im Sinne von A_21404 besitzt, ist der öffentliche Schlüssel für die Validierung der Signed_Authentication_Data-Struktur geeignet, wenn der Anlagezeitpunkt des Pairings nicht mehr als 6 Monate zurückliegt (d.h. sofern die aktuelle Zeit &lt; pairing_entry.creationTime+6 Monate ist). Hierbei DARF auf den vollen Tag aufgerundet werden. Ist dies nicht der Fall, so MUSS die Verarbeitung mit einer Fehlermeldung abgebrochen werden. Die Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein.</li></ul>]]></description_html>
  </requirement>
  <requirement id="A_21438" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116922" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Validierung der mathematischen Integrität der signierten Authentication_Data-Struktur]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS die Integrität der übermittelten 
Signed_Authentication_Data mithilfe des öffentlichen Schlüssels aus dem 
Pairing-Datensatz überprüfen. Sofern sich die Daten als nicht (mathematisch) 
integer erweisen MUSS der Authorization-Endpunkt den Prozess mit einer 
Fehlermeldung abbrechen. Die Fehlermeldungen MUSS „access_denied“ mit 
„error_description“ VAL.1 sein.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS die Integrität der übermittelten Signed_Authentication_Data mithilfe des öffentlichen Schlüssels aus dem Pairing-Datensatz überprüfen. Sofern sich die Daten als nicht (mathematisch) integer erweisen MUSS der Authorization-Endpunkt den Prozess mit einer Fehlermeldung abbrechen. Die Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein.<br/>]]></description_html>
  </requirement>
  <requirement id="A_21439" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116923" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Zu unterstützende Algorithmen zur Prüfung der mathematischen Integrität der signierten Authentication_Data-Struktur]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS im Zuge der Validierung der mathematischen 
Integrität der Signed_Authentication_Data-Struktur die folgenden Algorithmen 
unterstützen: ECDSA mit Kurve P-256 und SHA-256.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS im Zuge der Validierung der mathematischen Integrität der Signed_Authentication_Data-Struktur die folgenden Algorithmen unterstützen: ECDSA mit Kurve P-256 und SHA-256.<br/>]]></description_html>
  </requirement>
  <requirement id="A_21440" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116924" revision="426785">
    <title><![CDATA[Erweiterung des Authorization-Endpunkts: Produktion des Authorization Code und eines SSO_TOKEN]]></title>
    <description><![CDATA[Der Authorization-Endpunkt MUSS nach erfolgreicher Prüfung der 
Signed_Authentication_Data einen Authorization Code und einen SSO_TOKEN 
produzieren. Basis für die Claims liefert das übertragene 
Authentifizierungszertifikat und die Claims aus der Datenstruktur 
Authentication_Data.Unter "Authentifizierungszertifikat" wird ein Zertifikat 
des Typs C.CH.AUT verstanden. In den produzierten SSO_TOKEN und 
AUTHORIZATION_CODES MUSS der „amr“-Claim identisch zu dem gleichnamigen Claim 
in der Authentication_Data-Struktur gesetzt werden.]]></description>
    <description_html><![CDATA[Der Authorization-Endpunkt MUSS nach erfolgreicher Prüfung der Signed_Authentication_Data einen Authorization Code und einen SSO_TOKEN produzieren. Basis für die Claims liefert das übertragene Authentifizierungszertifikat und die Claims aus der Datenstruktur Authentication_Data. <span style="font-size: 10pt;line-height: 1.5;">Unter &quot;Authentifizierungszertifikat&quot; wird ein Zertifikat des Typs C.CH.AUT verstanden. </span>In den produzierten SSO_TOKEN und AUTHORIZATION_CODES MUSS der „amr“-Claim identisch zu dem gleichnamigen Claim in der Authentication_Data-Struktur gesetzt werden.]]></description_html>
  </requirement>
  <requirement id="A_21450" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116934" revision="426785">
    <title><![CDATA[Inspektions- und Deregistrierungsfunktion des IdP-Dienstes: Datenmodell und Syntax zur Kommunikation mit dem Authenticator-Modul]]></title>
    <description><![CDATA[Die Inspektions- und Deregistrierungsfunktion des IdP-Dienstes MUSS die 
folgenden Datentypen zur Kommunikation mit dem Authenticator-Modul verwenden: 

 * Pairing_Entry
 * Pairing_Entries.]]></description>
    <description_html><![CDATA[Die Inspektions- und Deregistrierungsfunktion des IdP-Dienstes MUSS die folgenden Datentypen zur Kommunikation mit dem Authenticator-Modul verwenden: <br/> <ul><li>Pairing_Entry</li><li>Pairing_Entries.</li></ul>]]></description_html>
  </requirement>
  <requirement id="A_21441" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116925" revision="426785">
    <title><![CDATA[Inspektions- und Deregistrierungsfunktion des IDP-Dienstes: Fehlermeldungen]]></title>
    <description><![CDATA[Der Pairing-Endpunkt des IdP-Dienstes MUSS im Zusammenhang mit der Inspektions- 
und Deregistrierungsfunktion die folgenden Fehlermeldungen produzieren:


Tabelle #: Fehlermeldungen Inspektions- und Deregistrierungsfunktion

NummerFehlermeldungstext
AC.1Der Zugriff auf den Dienst kann nicht gewährt werden.
AC.2Die Registrierungsdaten konnten nicht bezogen werden.
AC.3Der Auftrag zur Deaktivierung des Pairings konnte nicht angenommen werden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt des IdP-Dienstes MUSS im Zusammenhang mit der Inspektions- und Deregistrierungsfunktion die folgenden Fehlermeldungen produzieren:<br/> <br/> <p style="text-align: left;" class="polarion-rte-caption-paragraph">Tabelle <span class="polarion-rte-caption" data-sequence="Tabelle">#</span>: Fehlermeldungen Inspektions- und Deregistrierungsfunktion</p><table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%"><tbody><tr><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 98.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Nummer</th><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 762px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Fehlermeldungstext</th></tr><tr><td style="text-align: left;vertical-align: top;width: 98.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">AC.1</td><td style="text-align: left;vertical-align: top;width: 762px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Der Zugriff auf den Dienst kann nicht gewährt werden.</td></tr><tr><td style="text-align: left;vertical-align: top;width: 98.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">AC.2</td><td style="text-align: left;vertical-align: top;width: 762px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Die Registrierungsdaten konnten nicht bezogen werden.</td></tr><tr><td style="text-align: left;vertical-align: top;width: 98.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">AC.3</td><td style="text-align: left;vertical-align: top;width: 762px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Der Auftrag zur Deaktivierung des Pairings konnte nicht angenommen werden.</td></tr></tbody></table>]]></description_html>
  </requirement>
  <requirement id="A_21445" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116929" revision="426785">
    <title><![CDATA[Inspektions- und Deregistrierungsfunktion des IdP-Dienstes: Validierung und Verarbeitung des ACCESS_TOKEN]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS das bezogene ACCESS_TOKEN mit dem privaten Schlüssel 
PrK.IDP.ENC entschlüsseln. Das zur Entschlüsselung des ACCESS_TOKEN zu 
verwendende Verfahren ist ECDH-ES. Die Prüfung des ACCESS_TOKENS erfolgt wie in 
[gemSpec_IDP_FD], Abschnitt 6 beschrieben. Sofern das ACCESS_TOKEN ungültig 
ist, MUSS dem Authenticator-Modul die Fehlermeldung AC.1 übermittelt werden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS das bezogene ACCESS_TOKEN mit dem privaten Schlüssel PrK.IDP.ENC entschlüsseln. Das zur Entschlüsselung des ACCESS_TOKEN zu verwendende Verfahren ist ECDH-ES. Die Prüfung des ACCESS_TOKENS erfolgt wie in [gemSpec_IDP_FD], Abschnitt 6 beschrieben. Sofern das ACCESS_TOKEN ungültig ist, MUSS dem Authenticator-Modul die Fehlermeldung AC.1 übermittelt werden.]]></description_html>
  </requirement>
  <requirement id="A_21452" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116963" revision="426785">
    <title><![CDATA[Inspektions- und Deregistrierungsfunktion des IdP-Dienstes: Rückgabe der Pairing-Daten]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS die idNummer des Benutzers aus den Claims des 
ACCESS_TOKEN extrahieren und die Pairing-Datenbank anhand der idNummer nach den 
bestehenden Pairings des Benutzers abfragen. Die bezogenen Pairing-Daten MÜSSEN 
dem Authenticator-Modul übermittelt werden. Die Antwort MUSS eine Liste von 
Pairing_Entry-Daten sein. Sofern die Daten nicht bezogen werden konnten, MUSS 
dem Authenticator-Modul die Fehlermeldung AC.2 übermittelt werden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS die idNummer des Benutzers aus den Claims des ACCESS_TOKEN extrahieren und die Pairing-Datenbank anhand der idNummer nach den bestehenden Pairings des Benutzers abfragen. Die bezogenen Pairing-Daten MÜSSEN dem Authenticator-Modul übermittelt werden. Die Antwort MUSS eine Liste von Pairing_Entry-Daten sein. Sofern die Daten nicht bezogen werden konnten, MUSS dem Authenticator-Modul die Fehlermeldung AC.2 übermittelt werden.]]></description_html>
  </requirement>
  <requirement id="A_21447" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116931" revision="426785">
    <title><![CDATA[Inspektions- und Deregistrierungsfunktion des IdP-Dienstes: Annahme des Kommandos zur Deaktivierung des Pairings]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS das Kommando zum Deaktivieren eines Pairing-Eintrags 
annehmen. Das Kommando umfasst dabei das ACCESS_TOKEN und den Key-Identifier 
des zu deaktivierenden Pairing-Eintrages. Der Pairing-Eintrag MUSS anhand von 
Key-Identifier und der im ACCESS_TOKEN enthaltenen idNummer identifiziert und 
deaktiviert werden.]]></description>
    <description_html><![CDATA[Der Pairing-Endpunkt MUSS das Kommando zum Deaktivieren eines Pairing-Eintrags annehmen. Das Kommando umfasst dabei das ACCESS_TOKEN und den Key-Identifier des zu deaktivierenden Pairing-Eintrages. Der Pairing-Eintrag MUSS anhand von Key-Identifier und der im ACCESS_TOKEN enthaltenen idNummer identifiziert und deaktiviert werden.]]></description_html>
  </requirement>
  <requirement id="A_21448" type="leafRequirement" severity="MUSS" lastUpdate="2021-06-15" technicalID="ML-116932" revision="426785">
    <title><![CDATA[Inspektions- und Deregistrierungsfunktion des IdP-Dienstes: Deaktivierung des identifizierten Pairing-Datensatzes]]></title>
    <description><![CDATA[Der Pairing-Endpunkt MUSS den zur Deaktivierung angefragten Pairing-Datensatz 
anhand der Kombination aus dem übermittelten Key-Identifier und der aus dem 
ACCESS_TOKEN bezogenen idNummer identifizieren. Das verwendete Pairing MUSS 
dauerhaft deaktiviert werden. Die zur Authentifizierung verwendeten 
Authentifizierungsschlüssel dürfen nicht mehr verwendet werden. Sofern der 
Auftrag zur Deaktivierung nicht angenommen werden konnte, MUSS der 
Pairing-Endpunkt dem Authenticator-Modul die Fehlermeldung AC.3 übermitteln.]]></description>
    <description_html><![CDATA[<span style="font-size: 10pt;line-height: 1.5;">Der Pairing-Endpunkt MUSS den zur Deaktivierung angefragten Pairing-Datensatz anhand der Kombination aus dem übermittelten Key-Identifier und der aus dem ACCESS_TOKEN bezogenen idNummer identifizieren. Das verwendete Pairing MUSS dauerhaft deaktiviert werden. Die zur Authentifizierung verwendeten Authentifizierungsschlüssel dürfen nicht mehr verwendet werden. Sofern der Auftrag zur Deaktivierung nicht angenommen werden konnte, MUSS der Pairing-Endpunkt dem Authenticator-Modul die Fehlermeldung AC.3 übermitteln.</span>]]></description_html>
  </requirement>
  <requirement id="A_21454" type="leafRequirement" severity="MUSS" lastUpdate="2021-09-30" technicalID="ML-116981" revision="426785">
    <title><![CDATA[Performance - IdP-Dienst - Deregistrierung eines Pairings]]></title>
    <description><![CDATA[Der Anbieter des IdP-Dienstes MUSS sicherstellen, dass ein in der 
Pairing-Datenbank gespeichertes Pairing auf Anfrage des Nutzers innerhalb einer 
Stunde deaktiviert wird. Dies gilt auch für eine standortübergreifende 
Realisierung der einzelnen Endpunkte des IdP-Dienstes.]]></description>
    <description_html><![CDATA[Der Anbieter des IdP-Dienstes MUSS sicherstellen, dass ein in der Pairing-Datenbank gespeichertes Pairing auf Anfrage des Nutzers innerhalb einer Stunde deaktiviert wird. Dies gilt auch für eine standortübergreifende Realisierung der einzelnen Endpunkte des IdP-Dienstes.]]></description_html>
  </requirement>
  <requirement id="A_22262" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124949" revision="426785">
    <title><![CDATA[Bereitstellung eines Third-Party Authorization Endpoint]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS einen Third-Party Authorization Endpoint unter einer 
dedizierten URL bereitstellen und dort Authorization Requests und Authorization 
Codes eines sektoralen Identity Provider annehmen.]]></description>
    <description_html><![CDATA[Der IDP-Dienst MUSS einen Third-Party Authorization Endpoint unter einer dedizierten URL bereitstellen und dort Authorization Requests und Authorization Codes eines sektoralen Identity Provider annehmen.]]></description_html>
  </requirement>
  <requirement id="A_22263" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124951" revision="426785">
    <title><![CDATA[Sitzungsmanagement des IDP-Dienstes zu einem sektoralen Identity Provider]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS für Anfragen zur Authentisierung an einem sektoralen 
Identity Provider die folgenden Daten zur späteren Korrelation der Anfragen in 
einer Sitzung speichern:

QuelleParameterErläuterung
E-Rezept-FdV/Daten aus dem Authorization Request des E-Rezept-FdVclient_idDies 
ist die client-id des Anwendungsfrontend.
nonce_erpDies ist die Nonce für das ID-Token, das zum Anwendungsfrontend 
gesendet werden soll.
state_erpstate-Parameter des Anwendungsfrontend
code_challengecode_challenge des Anwendungsfrontend
IDP-Dienst/Daten des Authorization Request des IDP-Dienstes an den sektoralen 
Identity Providernonce_idpNonce für das ID-Token des sektoralen Identity 
Provider
code_verifierCode-Verifier des IDP-Dienstes zur Abfrage des ID-Token
kk_app_id Identifier für das zu nutzende Authenticator-Modul des angefragten 
sektoralen Identity Provider
state_idpstate-Parameter es IDP-Dienstes zur Abfrage des ID-Tokenf
 Über diesen Wert wird die Sitzung anschließend referenziert.Der IDP-Dienst 
MUSS diese Daten über den von ihm generierten state-Parameter referenzieren und 
in den späteren Anwendungsfällen dereferenzieren können.]]></description>
    <description_html><![CDATA[Der IDP-Dienst MUSS für Anfragen zur Authentisierung an einem sektoralen Identity Provider die folgenden Daten zur späteren Korrelation der Anfragen in einer Sitzung speichern:<br/> <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"><tbody><tr><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 215.45px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Quelle</th><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 133.288px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Parameter</th><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 220.462px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Erläuterung</th></tr><tr><td rowspan="4" style="text-align: left;vertical-align: top;width: 215.45px;height: 205.8px;border: 1px solid #CCCCCC;padding: 5px;">E-Rezept-FdV/Daten aus dem Authorization Request des E-Rezept-FdV</td><td style="text-align: left;vertical-align: top;width: 133.288px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">client_id</td><td style="text-align: left;vertical-align: top;width: 220.462px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">Dies ist die client-id des Anwendungsfrontend.</td></tr><tr><td style="text-align: left;vertical-align: top;width: 133.288px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">nonce_erp</td><td style="text-align: left;vertical-align: top;width: 220.462px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">Dies ist die Nonce für das ID-Token, das zum Anwendungsfrontend gesendet werden soll.</td></tr><tr><td style="text-align: left;vertical-align: top;width: 133.288px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">state_erp</td><td style="text-align: left;vertical-align: top;width: 220.462px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">state-Parameter des Anwendungsfrontend</td></tr><tr><td style="text-align: left;vertical-align: top;width: 133.288px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">code_challenge</td><td style="text-align: left;vertical-align: top;width: 220.462px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">code_challenge des Anwendungsfrontend</td></tr><tr><td rowspan="4" style="text-align: left;vertical-align: top;width: 215.45px;height: 244.2px;border: 1px solid #CCCCCC;padding: 5px;">IDP-Dienst/Daten des Authorization Request des IDP-Dienstes an den sektoralen Identity Provider</td><td style="text-align: left;vertical-align: top;width: 133.288px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">nonce_idp</td><td style="text-align: left;vertical-align: top;width: 220.462px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">Nonce für das ID-Token des sektoralen Identity Provider</td></tr><tr><td style="text-align: left;vertical-align: top;width: 133.288px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">code_verifier</td><td style="text-align: left;vertical-align: top;width: 220.462px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">Code-Verifier des IDP-Dienstes zur Abfrage des ID-Token</td></tr><tr><td style="text-align: left;vertical-align: top;width: 133.288px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">kk_app_id </td><td style="text-align: left;vertical-align: top;width: 220.462px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">Identifier für das zu nutzende Authenticator-Modul des angefragten sektoralen Identity Provider</td></tr><tr><td style="text-align: left;vertical-align: top;width: 133.288px;height: 76.8px;border: 1px solid #CCCCCC;padding: 5px;">state_idp</td><td style="text-align: left;vertical-align: top;width: 220.462px;height: 76.8px;border: 1px solid #CCCCCC;padding: 5px;">state-Parameter es IDP-Dienstes zur Abfrage des ID-Tokenf<br/> Über diesen Wert wird die Sitzung anschließend referenziert.</td></tr></tbody></table>Der IDP-Dienst MUSS diese Daten über den von ihm generierten state-Parameter referenzieren und in den späteren Anwendungsfällen dereferenzieren können.]]></description_html>
  </requirement>
  <requirement id="A_22264" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124953" revision="426785">
    <title><![CDATA[Authorization-Request des IDP-Dienstes an sektorale Identity Provider]]></title>
    <description><![CDATA[Wenn der Authorization Request einen Parameter "kk_app_id" mit dem 
Identifikator eines sektoralen Authenticator-Moduls enthält, MUSS der 
IDP-Dienst selbst einen Authorization Request als Client an den zugehörigen 
sektoralen Identity Provider stellen. Der Request wird in Form eines 
HTTP-302-redirect als Antwort auf dessen Authorisierungs-Request zurück an das 
Authenticator-Modul gesendet. Die "target_url" des "redirect" ist dabei die URL 
des Authenticator-Moduls des sektoralen Identity Provider, welches durch den 
Parameter "kk_app_id" gewählt wurde. Hierbei sind die folgenden Parameter zu 
verwenden:

ParameterWertAnmerkung
client_id"zentraler idp-dienst"

statedynamisch und zufällig zu erzeugenDiesen State verwendet der IDP-Dienst, 
um die später erhaltene Antwort zuzuordnen.
redirect_uridie Adresse des Authenticator-Moduls des IDP-DienstesDiese wird 
aus der ursprünglichen Anfrage übernommen.
code_challengemit der Methode "S256" erzeugter Hash des Code-Verifier

code_challenge_method"S256" 

response_typecode

noncedynamisch und zufällig zu erzeugenNonce für das vom sektoralen IDP-Dienst 
zu erzeugende ID-Token
scope"erp_sek_auth+openid"]]></description>
    <description_html><![CDATA[Wenn der Authorization Request einen Parameter &quot;kk_app_id&quot; mit dem Identifikator eines sektoralen Authenticator-Moduls enthält, MUSS der IDP-Dienst selbst einen Authorization Request als Client an den zugehörigen sektoralen Identity Provider stellen. Der Request wird in Form eines HTTP-302-redirect als Antwort auf dessen Authorisierungs-Request zurück an das Authenticator-Modul gesendet. Die &quot;target_url&quot; des &quot;redirect&quot; ist dabei die URL des Authenticator-Moduls des sektoralen Identity Provider, welches durch den Parameter &quot;kk_app_id&quot; gewählt wurde. Hierbei sind die folgenden Parameter zu verwenden:<br/> <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"><tbody><tr><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 138.788px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Parameter</th><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 205.337px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Wert</th><th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 225.075px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Anmerkung</th></tr><tr><td style="text-align: left;vertical-align: top;width: 138.788px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">client_id</td><td style="text-align: left;vertical-align: top;width: 205.337px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">&quot;zentraler idp-dienst&quot;</td><td style="text-align: left;vertical-align: top;width: 225.075px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;"><br/></td></tr><tr><td style="text-align: left;vertical-align: top;width: 138.788px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">state</td><td style="text-align: left;vertical-align: top;width: 205.337px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">dynamisch und zufällig zu erzeugen</td><td style="text-align: left;vertical-align: top;width: 225.075px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">Diesen State verwendet der IDP-Dienst, um die später erhaltene Antwort zuzuordnen.</td></tr><tr><td style="text-align: left;vertical-align: top;width: 138.788px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">redirect_uri</td><td style="text-align: left;vertical-align: top;width: 205.337px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">die Adresse des Authenticator-Moduls des IDP-Dienstes</td><td style="text-align: left;vertical-align: top;width: 225.075px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">Diese wird aus der ursprünglichen Anfrage übernommen.</td></tr><tr><td style="text-align: left;vertical-align: top;width: 138.788px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">code_challenge</td><td style="text-align: left;vertical-align: top;width: 205.337px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">mit der Methode &quot;S256&quot; erzeugter Hash des Code-Verifier</td><td style="text-align: left;vertical-align: top;width: 225.075px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;"><br/></td></tr><tr><td style="text-align: left;vertical-align: top;width: 138.788px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">code_challenge_method</td><td style="text-align: left;vertical-align: top;width: 205.337px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">&quot;S256&quot; </td><td style="text-align: left;vertical-align: top;width: 225.075px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;"><br/></td></tr><tr><td style="text-align: left;vertical-align: top;width: 138.788px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">response_type</td><td style="text-align: left;vertical-align: top;width: 205.337px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">code</td><td style="text-align: left;vertical-align: top;width: 225.075px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;"><br/></td></tr><tr><td style="text-align: left;vertical-align: top;width: 138.788px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">nonce</td><td style="text-align: left;vertical-align: top;width: 205.337px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">dynamisch und zufällig zu erzeugen</td><td style="text-align: left;vertical-align: top;width: 225.075px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">Nonce für das vom sektoralen IDP-Dienst zu erzeugende ID-Token</td></tr><tr><td style="text-align: left;vertical-align: top;width: 138.788px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">scope</td><td style="text-align: left;vertical-align: top;width: 205.337px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">&quot;erp_sek_auth+openid&quot;</td><td style="text-align: left;vertical-align: top;width: 225.075px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;"><br/></td></tr></tbody></table>]]></description_html>
  </requirement>
  <requirement id="A_22265" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124952" revision="426785">
    <title><![CDATA[Token Request des IDP-Dienstes an sektorale Identity Provider]]></title>
    <description><![CDATA[Bei eingehenden Authorization Requests am Third-Party Authorization Endpoint, 
die anstelle eines Challenge_Token den AUTHORIZATION_CODE_IDP eines sektoralen 
Identity Provider enthalten, MUSS der IDP-Dienst anhand des state-Parameters 
die in [A_22263] definierten Sitzungsdaten rekonstruieren, selbst einen Token 
Request an den sektoralen Identity Provider stellen und dabei als 'Confidential 
Client' agieren.

 Der entsprechende sektorale Identity Provider ergibt sich dabei aus der 
gewählten "kk_app_id" der Anfrage. Als "redirect_uri" ist die übermittelte 
Adresse des Authenticator-Moduls des sektoralen Identity Provider ("
kk_app_redirect_uri") zu verwenden.

 Hierbei sind die folgenden Inhalte zu verwenden:


Parameter
Wert Anmerkung 
grant_type authorization_code 
code AUTHORIZATION_CODE_IDP Authorization_Code des sektoralen Identity Provider
code_verifier <code_verifier des IDP-Dienstes> aus den Sitzungsdaten 
client_id "zentraler-idp-dienst" 
redirect_uri kk_app_redirect_uri zusammen mit dem AUTHORIZATION_CODE 
übermittelte Adresse 
client_assertion_type "urn:ietf:params:oauth:client-assertion-type:jwt-bearer" 
 
 Authentisierung des confidential client entsprechend 
https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication 
<https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication>
 durch ein signiertes JWT 
client_assertion  private_key_jwt 
 Der Timeout, mit dem ein Request zum sektoralen Identity Provider abgebrochen 
werden darf, wird einheitlich für alle Abfragen (und analog zur Festlegung im 
Kontext der OCSP Requests) auf 1100 ms festgelegt.]]></description>
    <description_html><![CDATA[Bei eingehenden Authorization Requests am <span style="font-size: 10pt;line-height: 1.5;">Third-Party Authorization Endpoint, </span>die anstelle eines Challenge_Token den AUTHORIZATION_CODE_IDP eines sektoralen Identity Provider enthalten, MUSS der IDP-Dienst anhand des state-Parameters die in [<span style="font-size: 10pt;line-height: 1.5;">A_22263] </span>definierten Sitzungsdaten rekonstruieren, selbst einen Token Request an den sektoralen Identity Provider stellen und dabei als &#39;Confidential Client&#39; agieren. <br/>
 <br/>
Der entsprechende sektorale Identity Provider ergibt sich dabei aus der gewählten &quot;kk_app_id&quot; der Anfrage. Als &quot;redirect_uri&quot; ist die übermittelte Adresse des Authenticator-Moduls des sektoralen Identity Provider (&quot;<span style="font-size: 10pt;line-height: 1.5;">kk_app_redirect_uri&quot;) </span>zu verwenden.<br/>
 <br/>
Hierbei sind die folgenden Inhalte zu verwenden:<br/>
 <br/>
 
<table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
  <tbody>
    <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 91.3125px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Parameter<br/>
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 165.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wert</th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 312.788px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anmerkung</th>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">grant_type</td>
      <td style="text-align: left;vertical-align: top;width: 165.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">authorization_code</td>
      <td style="text-align: left;vertical-align: top;width: 312.788px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">code</td>
      <td style="text-align: left;vertical-align: top;width: 165.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">AUTHORIZATION_CODE_IDP</td>
      <td style="text-align: left;vertical-align: top;width: 312.788px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Authorization_Code des sektoralen Identity Provider</td>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">code_verifier</td>
      <td style="text-align: left;vertical-align: top;width: 165.1px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&lt;code_verifier des IDP-Dienstes&gt;</td>
      <td style="text-align: left;vertical-align: top;width: 312.788px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">aus den Sitzungsdaten</td>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">client_id</td>
      <td style="text-align: left;vertical-align: top;width: 165.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&quot;zentraler-idp-dienst&quot;</td>
      <td style="text-align: left;vertical-align: top;width: 312.788px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">redirect_uri</td>
      <td style="text-align: left;vertical-align: top;width: 165.1px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">kk_app_redirect_uri</td>
      <td style="text-align: left;vertical-align: top;width: 312.788px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">zusammen mit dem AUTHORIZATION_CODE übermittelte Adresse</td>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">client_assertion_type</span></td>
      <td style="text-align: left;vertical-align: top;width: 165.1px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&quot;urn:ietf:params:oauth:client-assertion-type:jwt-bearer&quot;</td>
      <td colspan="1" rowspan="2" style="text-align: left;vertical-align: top;width: 312.788px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;"> <br/>
        Authentisierung des confidential client entsprechend <a href="https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication" target="_top" class="descriptionLink">https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication</a> durch ein signiertes JWT</td>
    </tr>
    <tr>
      <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 76.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">client_assertion </td>
      <td style="text-align: left;vertical-align: top;width: 165.1px;height: 76.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">private_key_jwt</td>
    </tr>
  </tbody>
</table>
<br/>
Der Timeout, mit dem ein Request zum sektoralen Identity Provider abgebrochen werden darf, wird einheitlich für alle Abfragen (und analog zur Festlegung im Kontext der OCSP Requests) auf 1100 ms festgelegt.]]></description_html>
  </requirement>
  <requirement id="A_22266" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124954" revision="426785">
    <title><![CDATA[Authentisierung des IDP-Dienstes gegenüber den sektoralen Identity Providern]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS sich gegenüber dem Token-Endpunkt des sektoralen Identity 
Providerentsprechend 
https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication als 
'confidential client' mit einem "private_key_jwt" authentisieren.
Dieses "private_key_jwt" hat eine maximale Gültigkeit von 3 Minuten und muss 
mit dem Schlüssel "PuK_IDP_SIG_Sek" signiert werden.]]></description>
    <description_html><![CDATA[Der IDP-Dienst MUSS sich gegenüber dem Token-Endpunkt des sektoralen Identity Provider <span style="font-size: 10pt;line-height: 1.5;">entsprechend https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication als 'confidential client' mit einem &quot;private_key_jwt&quot; authentisieren.</span><br/> <span style="font-size: 10pt;line-height: 1.5;">Dieses &quot;private_key_jwt&quot; hat eine maximale Gültigkeit von 3 Minuten und muss mit dem Schlüssel &quot;PuK_IDP_SIG_Sek&quot; signiert werden.</span>]]></description_html>
  </requirement>
  <requirement id="A_22268" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124976" revision="426785">
    <title><![CDATA[Prüfung des ID-Token eines sektoralen Identity Provider]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS empfangene ID-Token auf Authentizität gemäß 
[OpenID.Core#3.1.3.7] prüfen.
Insbesondere MUSS die Signatur mit einem unter "jwks_uri" referenzierter 
öffentlichen Schlüssel aus dem Discovery Document des sektoralen Identity 
Provider prüfbar sein. Dieser ist über die "kid" aus der Signatur des Token 
auszuwählen.
Des Weiteren MUSS der IDP-Dienst prüfen, ob die im ID-Token enthaltene Nonce 
dem Wert "nonce_idp" aus den Sitzungsdaten der Session entspricht.]]></description>
    <description_html><![CDATA[Der IDP-Dienst MUSS empfangene ID-Token auf Authentizität gemäß [OpenID.Core#3.1.3.7] prüfen.<br/>Insbesondere MUSS die Signatur mit einem unter &quot;jwks_uri&quot; referenzierter öffentlichen Schlüssel aus dem Discovery Document des sektoralen Identity Provider prüfbar sein. Dieser ist über die &quot;kid&quot; aus der Signatur des Token auszuwählen. <br/>Des Weiteren MUSS der IDP-Dienst prüfen, ob die im ID-Token enthaltene Nonce dem Wert &quot;nonce_idp&quot; aus den Sitzungsdaten der Session entspricht.]]></description_html>
  </requirement>
  <requirement id="A_22269" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124974" revision="426785">
    <title><![CDATA[Produktion eines Authorization Code nach Bestätigung des sektoralen Identity Provider]]></title>
    <description><![CDATA[Nach erfolgreicher Prüfung des ID-Token MUSS der IDP-Dienst auf Basis der 
Sitzungsdaten und der Inhalte der Claims einen Authorization Code wie in 
[gemSpec_IDP#5.2.2] beschrieben produzieren und diesen zusammen mit dem 
gespeicherten 'State' und einem SSO_TOKEN an das Anwendungsfrontend übermitteln.]]></description>
    <description_html><![CDATA[Nach erfolgreicher Prüfung des ID-Token MUSS der IDP-Dienst auf Basis der Sitzungsdaten und der Inhalte der Claims einen Authorization Code wie in [gemSpec_IDP#5.2.2] beschrieben produzieren und diesen zusammen mit dem gespeicherten 'State' und einem SSO_TOKEN an das Anwendungsfrontend übermitteln.]]></description_html>
  </requirement>
  <requirement id="A_22270" type="leafRequirement" severity="MUSS" lastUpdate="2021-12-15" technicalID="ML-124975" revision="426785">
    <title><![CDATA[Löschung der Sitzungsdaten zum sektoralen Identity Provider]]></title>
    <description><![CDATA[Der IDP-Dienst MUSS nach erfolgter Ausstellung des Authorization Code oder 
Abbruch des Prozesses die unter dem vom ihm erzeugten 'State' gespeicherten 
Sitzungsdaten zur Anfrage an einen sektoralen Identity Provider löschen. ]]></description>
    <description_html><![CDATA[Der IDP-Dienst MUSS nach erfolgter Ausstellung des Authorization Code oder Abbruch des Prozesses die unter dem vom ihm erzeugten 'State' gespeicherten Sitzungsdaten zur Anfrage an einen sektoralen Identity Provider löschen. ]]></description_html>
  </requirement>
</requirements>
